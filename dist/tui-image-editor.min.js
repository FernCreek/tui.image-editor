/*!
 * tui-image-editor.min.js
 * @version 3.5.2-alm.6
 * @author NHNEnt FE Development Lab <dl_javascript@nhnent.com>
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("fabric/dist/fabric.require")):"function"==typeof define&&define.amd?define(["fabric/dist/fabric.require"],t):"object"==typeof exports?exports.ImageEditor=t(require("fabric/dist/fabric.require")):(e.tui=e.tui||{},e.tui.ImageEditor=t(e.fabric))}(this,function(e){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="dist",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}n(89);var o=n(86),r=i(o);n(43),n(44),n(45),n(46),n(47),n(48),n(49),n(50),n(51),n(52),n(53),n(54),n(55),n(56),n(57),n(58),n(59),n(61),n(60),e.exports=r.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(9),r=i(o);e.exports={componentNames:r.default.keyMirror("IMAGE_LOADER","CROPPER","FLIP","ROTATION","FREE_DRAWING","LINE","TEXT","ICON","FILTER","SHAPE"),commandNames:{CLEAR_OBJECTS:"clearObjects",LOAD_IMAGE:"loadImage",FLIP_IMAGE:"flip",ROTATE_IMAGE:"rotate",ADD_OBJECT:"addObject",REMOVE_OBJECT:"removeObject",APPLY_FILTER:"applyFilter",REMOVE_FILTER:"removeFilter",ADD_ICON:"addIcon",CHANGE_ICON_COLOR:"changeIconColor",ADD_SHAPE:"addShape",CHANGE_SHAPE:"changeShape",ADD_TEXT:"addText",CHANGE_TEXT:"changeText",CHANGE_TEXT_STYLE:"changeTextStyle",ADD_IMAGE_OBJECT:"addImageObject",RESIZE_CANVAS_DIMENSION:"resizeCanvasDimension",SET_OBJECT_PROPERTIES:"setObjectProperties",SET_OBJECT_POSITION:"setObjectPosition"},eventNames:{OBJECT_ACTIVATED:"objectActivated",OBJECT_REMOVED:"objectRemoved",OBJECT_ROTATING:"objectRotating",OBJECT_MOVED:"objectMoved",OBJECT_SCALED:"objectScaled",OBJECT_CREATED:"objectCreated",TEXT_EDITING:"textEditing",TEXT_CHANGED:"textChanged",ICON_CREATE_RESIZE:"iconCreateResize",ICON_CREATE_END:"iconCreateEnd",ADD_TEXT:"addText",ADD_OBJECT:"addObject",ADD_OBJECT_AFTER:"addObjectAfter",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_MOVE:"mousemove",REDO_STACK_CHANGED:"redoStackChanged",UNDO_STACK_CHANGED:"undoStackChanged",SELECTION_CLEARED:"selectionCleared",SELECTION_CREATED:"selectionCreated"},drawingModes:r.default.keyMirror("NORMAL","CROPPER","FREE_DRAWING","LINE_DRAWING","TEXT","SHAPE"),keyCodes:{Z:90,Y:89,SHIFT:16,BACKSPACE:8,DEL:46},fObjectOptions:{SELECTION_STYLE:{borderColor:"red",cornerColor:"green",cornerSize:10,originX:"center",originY:"center",transparentCorners:!1}},rejectMessages:{addedObject:"The object is already added.",flip:"The flipX and flipY setting values are not changed.",invalidDrawingMode:"This operation is not supported in the drawing mode.",invalidParameters:"Invalid parameters.",isLock:"The executing command state is locked.",loadImage:"The background image is empty.",loadingImageFailed:"Invalid image loaded.",noActiveObject:"There is no active object.",noObject:"The object is not in canvas.",redo:"The promise of redo command is reject.",rotation:"The current angle is same the old angle.",undo:"The promise of undo command is reject.",unsupportedOperation:"Unsupported operation.",unsupportedType:"Unsupported object type."},defaultIconPath:{"icon-arrow":"M40 12V0l24 24-24 24V36H0V12h40z","icon-arrow-2":"M49,32 H3 V22 h46 l-18,-18 h12 l23,23 L43,50 h-12 l18,-18  z ","icon-arrow-3":"M43.349998,27 L17.354,53 H1.949999 l25.996,-26 L1.949999,1 h15.404 L43.349998,27  z ","icon-star":"M35,54.557999 l-19.912001,10.468 l3.804,-22.172001 l-16.108,-15.7 l22.26,-3.236 L35,3.746 l9.956,20.172001 l22.26,3.236 l-16.108,15.7 l3.804,22.172001  z ","icon-star-2":"M17,31.212 l-7.194,4.08 l-4.728,-6.83 l-8.234,0.524 l-1.328,-8.226 l-7.644,-3.14 l2.338,-7.992 l-5.54,-6.18 l5.54,-6.176 l-2.338,-7.994 l7.644,-3.138 l1.328,-8.226 l8.234,0.522 l4.728,-6.83 L17,-24.312 l7.194,-4.08 l4.728,6.83 l8.234,-0.522 l1.328,8.226 l7.644,3.14 l-2.338,7.992 l5.54,6.178 l-5.54,6.178 l2.338,7.992 l-7.644,3.14 l-1.328,8.226 l-8.234,-0.524 l-4.728,6.83  z ","icon-polygon":"M3,31 L19,3 h32 l16,28 l-16,28 H19  z ","icon-location":"M24 62C8 45.503 0 32.837 0 24 0 10.745 10.745 0 24 0s24 10.745 24 24c0 8.837-8 21.503-24 38zm0-28c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10z","icon-heart":"M49.994999,91.349998 l-6.96,-6.333 C18.324001,62.606995 2.01,47.829002 2.01,29.690998 C2.01,14.912998 13.619999,3.299999 28.401001,3.299999 c8.349,0 16.362,5.859 21.594,12 c5.229,-6.141 13.242001,-12 21.591,-12 c14.778,0 26.390999,11.61 26.390999,26.390999 c0,18.138 -16.314001,32.916 -41.025002,55.374001 l-6.96,6.285  z ","icon-bubble":"M44 48L34 58V48H12C5.373 48 0 42.627 0 36V12C0 5.373 5.373 0 12 0h40c6.627 0 12 5.373 12 12v24c0 6.627-5.373 12-12 12h-8z"},defaultRotateRangeValus:{realTimeEvent:!0,min:-360,max:360,value:0},defaultDrawRangeValus:{min:5,max:30,value:12},defaultShapeStrokeValus:{realTimeEvent:!1,min:2,max:300,value:3},defaultTextRangeValus:{realTimeEvent:!0,min:10,max:100,value:50},defaultFilterRangeValus:{tintOpacityRange:{min:0,max:1,value:.7},removewhiteThresholdRange:{min:0,max:255,value:60},removewhiteDistanceRange:{min:0,max:255,value:10},gradientTransparencyRange:{min:0,max:255,value:100},brightnessRange:{min:-255,max:255,value:100},noiseRange:{min:0,max:1e3,value:100},pixelateRange:{min:2,max:20,value:4},colorfilterThresholeRange:{min:0,max:255,value:45}},defaultPixelTargetTolerance:10}},function(e,t,n){n(118),n(120),n(121),n(119),e.exports=n(13).Promise},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=u[e];if(t){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return new s.default(t,i)}return null}function r(e){u[e.name]=e}var a=n(87),s=i(a),u={};e.exports={create:o,register:r}},function(e,t){"use strict";function n(e){return void 0===e}function i(e){return e instanceof Function}function o(e){return"string"==typeof e||e instanceof String}function r(e,t,n){var i=0,o=e.length;for(n=n||null;i<o&&t.call(n,e[i],i,e)!==!1;i+=1);}function a(e,t,n){var i=void 0;n=n||null;for(i in e)if(e.hasOwnProperty(i)&&t.call(n,e[i],i,e)===!1)break}function s(e){return e instanceof Array}function u(e,t,n){s(e)?r(e,t,n):a(e,t,n)}function c(e,t){var n,i,o,r,a=Object.prototype.hasOwnProperty;for(o=1,r=arguments.length;o<r;o+=1){n=arguments[o];for(i in n)a.call(n,i)&&(e[i]=n[i])}return e}function l(e){return e.__fe_id||(v+=1,e.__fe_id=v),e.__fe_id}function f(e,t,n){var i=[];return n=n||null,u(e,function(){i.push(t.apply(n,arguments))}),i}function h(e){return e===Object(e)}function d(e,t,n){var o=void 0,r=void 0;if(n=n||null,!h(e)||!i(t))throw new Error("wrong parameter");return s(e)?(o=[],r=function(e,t){e.push(t[0])}):(o={},r=function(e,t){e[t[1]]=t[0]}),u(e,function(){t.apply(n,arguments)&&r(o,arguments)},n),o}function p(e){return null===e}function g(e){return!n(e)&&!p(e)}var v=0,m=function(e,t,n){var i=void 0;if(n=n||0,!s(t))return-1;if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e,n);for(i=n;n>=0&&i<t.length;i+=1)if(t[i]===e)return i;return-1};e.exports={extend:c,filter:d,forEach:u,forEachArray:r,forEachOwnProperties:a,inArray:m,isArray:s,isExisty:g,isFunction:i,isObject:h,isString:o,isUndefined:n,map:f,stamp:l}},function(t,n){t.exports=e},function(e,t,n){var i=n(38)("wks"),o=n(41),r=n(8).Symbol,a="function"==typeof r,s=e.exports=function(e){return i[e]||(i[e]=a&&r[e]||(a?r:o)("Symbol."+e))};s.store=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,i){n(this,e),this.name=t,this.graphics=i}return i(e,[{key:"fire",value:function(){for(var e=this.graphics,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.graphics.fire.apply(e,n)}},{key:"setCanvasImage",value:function(e,t){this.graphics.setCanvasImage(e,t)}},{key:"getCanvasElement",value:function(){return this.graphics.getCanvasElement()}},{key:"getCanvas",value:function(){return this.graphics.getCanvas()}},{key:"getCanvasImage",value:function(){return this.graphics.getCanvasImage()}},{key:"getImageName",value:function(){return this.graphics.getImageName()}},{key:"getEditor",value:function(){return this.graphics.getEditor()}},{key:"getName",value:function(){return this.name}},{key:"setImageProperties",value:function(e,t){this.graphics.setImageProperties(e,t)}},{key:"setCanvasCssDimension",value:function(e){this.graphics.setCanvasCssDimension(e)}},{key:"setCanvasBackstoreDimension",value:function(e){this.graphics.setCanvasBackstoreDimension(e)}},{key:"adjustCanvasDimension",value:function(){this.graphics.adjustCanvasDimension()}},{key:"adjustCanvasDimensionForRotate",value:function(){this.graphics.adjustCanvasDimensionForRotate()}}]),e}();e.exports=o},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){"use strict";var i=n(4),o=Math.min,r=Math.max;e.exports={clamp:function(e,t,n){var i=void 0;return t>n&&(i=t,t=n,n=i),r(t,o(e,n))},keyMirror:function(){for(var e={},t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return(0,i.forEach)(n,function(t){e[t]=t}),e},makeStyleText:function(e){var t="";return(0,i.forEach)(e,function(e,n){t+=n+": "+e+";"}),t},getProperties:function(e,t){var n={},i=t.length,o=0,r=void 0;for(o=0;o<i;o+=1)r=t[o],n[r]=e[r];return n},toInteger:function(e){return parseInt(e,10)},toCamelCase:function(e){return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})},isSupportFileApi:function(){return!!(window.File&&window.FileList&&window.FileReader)},getRgb:function(e,t){4===e.length&&(e=""+e+e.slice(1,4));var n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16),r=t||1;return"rgba("+n+", "+i+", "+o+", "+r+")"},sendHostName:function(){},styleLoad:function(e,t){var n=document.getElementsByTagName("head"),i=n[0],o=document.createElement("link"),r=encodeURIComponent(e);t&&(o.id=t),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href","data:text/css;charset=UTF-8,"+r),i.appendChild(o)},getSelector:function(e){return function(t){return e.querySelector(t)}},base64ToBlob:function(e){var t=/data:(image\/.+);base64,/,n="",i=void 0,o=void 0,r=void 0;i=e.replace(t,function(e,t){return n=t,""}),i=atob(i);var a=i.length;for(o=new Uint8Array(a),r=0;r<a;r+=1)o[r]=i.charCodeAt(r);return new Blob([o],{type:n})}}},function(e,t,n){var i=n(19);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var i=n(20),o=n(37);e.exports=n(14)?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(29),s=i(a),u=s.default.create,c=s.default.types,l=function(){function e(t){o(this,e),this.name=t}return r(e,[{key:"getName",value:function(){return this.name}},{key:"start",value:function(){throw new Error(u(c.UN_IMPLEMENTATION,"start"))}},{key:"stop",value:function(){throw new Error(u(c.UN_IMPLEMENTATION,"stop"))}}]),e}();e.exports=l},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){e.exports=!n(33)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports={}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var i=n(22);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,o){return e.call(t,n,i,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var i=n(10),o=n(94),r=n(115),a=Object.defineProperty;t.f=n(14)?Object.defineProperty:function(e,t,n){if(i(e),t=r(t,!0),i(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";function i(){this.events=null,this.contexts=null}var o=n(4),r=/\s+/g;i.mixin=function(e){o.extend(e.prototype,i.prototype)},i.prototype._getHandlerItem=function(e,t){var n={handler:e};return t&&(n.context=t),n},i.prototype._safeEvent=function(e){var t=this.events,n=void 0;return t||(t=this.events={}),e&&(n=t[e],n||(n=[],t[e]=n),t=n),t},i.prototype._safeContext=function(){var e=this.contexts;return e||(e=this.contexts=[]),e},i.prototype._indexOfContext=function(e){for(var t=this._safeContext(),n=0;t[n];){if(e===t[n][0])return n;n+=1}return-1},i.prototype._memorizeContext=function(e){if(o.isExisty(e)){var t=this._safeContext(),n=this._indexOfContext(e);n>-1?t[n][1]+=1:t.push([e,1])}},i.prototype._forgetContext=function(e){if(o.isExisty(e)){var t=this._safeContext(),n=this._indexOfContext(e);n>-1&&(t[n][1]-=1,t[n][1]<=0&&t.splice(n,1))}},i.prototype._bindEvent=function(e,t,n){var i=this._safeEvent(e);this._memorizeContext(n),i.push(this._getHandlerItem(t,n))},i.prototype.on=function(e,t,n){var i=this;o.isString(e)?(e=e.split(r),o.forEach(e,function(e){i._bindEvent(e,t,n)})):o.isObject(e)&&(n=t,o.forEach(e,function(e,t){i.on(t,e,n)}))},i.prototype.once=function(e,t,n){function i(){t.apply(n,arguments),r.off(e,i,n)}var r=this;return o.isObject(e)?(n=t,void o.forEach(e,function(e,t){r.once(t,e,n)})):void this.on(e,i,n)},i.prototype._spliceMatches=function(e,t){var n=0,i=void 0;if(o.isArray(e))for(i=e.length;n<i;n+=1)t(e[n])===!0&&(e.splice(n,1),i-=1,n-=1)},i.prototype._matchHandler=function(e){var t=this;return function(n){var i=e===n.handler;return i&&t._forgetContext(n.context),i}},i.prototype._matchContext=function(e){var t=this;return function(n){var i=e===n.context;return i&&t._forgetContext(n.context),i}},i.prototype._matchHandlerAndContext=function(e,t){var n=this;return function(i){var o=e===i.handler,r=t===i.context,a=o&&r;return a&&n._forgetContext(i.context),a}},i.prototype._offByEventName=function(e,t){var n=this,i=o.forEachArray,a=o.isFunction(t),s=n._matchHandler(t);e=e.split(r),i(e,function(e){var t=n._safeEvent(e);a?n._spliceMatches(t,s):(i(t,function(e){n._forgetContext(e.context)}),n.events[e]=[])})},i.prototype._offByHandler=function(e){var t=this,n=this._matchHandler(e);o.forEach(this._safeEvent(),function(e){t._spliceMatches(e,n)})},i.prototype._offByObject=function(e,t){var n=this,i=void 0;this._indexOfContext(e)<0?o.forEach(e,function(e,t){n.off(t,e)}):o.isString(t)?(i=this._matchContext(e),n._spliceMatches(this._safeEvent(t),i)):o.isFunction(t)?(i=this._matchHandlerAndContext(t,e),o.forEach(this._safeEvent(),function(e){n._spliceMatches(e,i)})):(i=this._matchContext(e),o.forEach(this._safeEvent(),function(e){n._spliceMatches(e,i)}))},i.prototype.off=function(e,t){o.isString(e)?this._offByEventName(e,t):arguments.length?o.isFunction(e)?this._offByHandler(e):o.isObject(e)&&this._offByObject(e,t):(this.events={},this.contexts=[])},i.prototype.fire=function(e){this.invoke.apply(this,arguments)},i.prototype.invoke=function(e){var t=void 0;if(!this.hasListener(e))return!0;for(var n=this._safeEvent(e),i=Array.prototype.slice.call(arguments,1),o=0;n[o];){if(t=n[o],t.handler.apply(t.context,i)===!1)return!1;o+=1}return!0},i.prototype.hasListener=function(e){return this.getListenerLength(e)>0},i.prototype.getListenerLength=function(e){var t=this._safeEvent(e);return t.length},e.exports=i},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var i=n(19),o=n(8).document,r=i(o)&&i(o.createElement);e.exports=function(e){return r?o.createElement(e):{}}},function(e,t,n){var i=n(20).f,o=n(18),r=n(6)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},function(e,t,n){var i=n(38)("keys"),o=n(41);e.exports=function(e){return i[e]||(i[e]=o(e))}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){var i=n(96),o=n(23);e.exports=function(e){return i(o(e))}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(4),r=i(o),a=n(9),s=(0,a.keyMirror)("UN_IMPLEMENTATION","NO_COMPONENT_NAME"),u={UN_IMPLEMENTATION:"Should implement a method: ",NO_COMPONENT_NAME:"Should set a component name"},c={UN_IMPLEMENTATION:function(e){return u.UN_IMPLEMENTATION+e},NO_COMPONENT_NAME:function(){return u.NO_COMPONENT_NAME}};e.exports={types:r.default.extend({},s),create:function(e){e=e.toLowerCase();for(var t=c[e],n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return t.apply(void 0,i)}}},function(e,t,n){var i=n(16),o=n(6)("toStringTag"),r="Arguments"==i(function(){return arguments}()),a=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=a(t=Object(e),o))?n:r?i(t):"Object"==(s=i(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var i=n(8),o=n(13),r=n(17),a=n(11),s="prototype",u=function(e,t,n){var c,l,f,h=e&u.F,d=e&u.G,p=e&u.S,g=e&u.P,v=e&u.B,m=e&u.W,y=d?o:o[t]||(o[t]={}),_=y[s],b=d?i:p?i[t]:(i[t]||{})[s];d&&(n=t);for(c in n)l=!h&&b&&void 0!==b[c],l&&c in y||(f=l?b[c]:n[c],y[c]=d&&"function"!=typeof b[c]?n[c]:v&&l?r(f,i):m&&b[c]==f?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t[s]=e[s],t}(f):g&&"function"==typeof f?r(Function.call,f):f,g&&((y.virtual||(y.virtual={}))[c]=f,e&u.R&&_&&!_[c]&&a(_,c,f)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){e.exports=n(8).document&&document.documentElement},function(e,t,n){"use strict";var i=n(36),o=n(32),r=n(109),a=n(11),s=n(18),u=n(15),c=n(99),l=n(25),f=n(105),h=n(6)("iterator"),d=!([].keys&&"next"in[].keys()),p="@@iterator",g="keys",v="values",m=function(){return this};e.exports=function(e,t,n,y,_,b,O){c(n,t,y);var k,x,w,C=function(e){if(!d&&e in S)return S[e];switch(e){case g:return function(){return new n(this,e)};case v:return function(){return new n(this,e)}}return function(){return new n(this,e)}},E=t+" Iterator",j=_==v,M=!1,S=e.prototype,T=S[h]||S[p]||_&&S[_],A=T||C(_),I=_?j?C("entries"):A:void 0,P="Array"==t?S.entries||T:T;if(P&&(w=f(P.call(new e)),w!==Object.prototype&&(l(w,E,!0),i||s(w,h)||a(w,h,m))),j&&T&&T.name!==v&&(M=!0,A=function(){return T.call(this)}),i&&!O||!d&&!M&&S[h]||a(S,h,A),u[t]=A,u[E]=m,_)if(k={values:j?A:C(v),keys:b?A:C(g),entries:I},O)for(x in k)x in S||r(S,x,k[x]);else o(o.P+o.F*(d||M),t,k);return k}},function(e,t){e.exports=!0},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i=n(8),o="__core-js_shared__",r=i[o]||(i[o]={});e.exports=function(e){return r[e]||(r[e]={})}},function(e,t,n){var i,o,r,a=n(17),s=n(95),u=n(34),c=n(24),l=n(8),f=l.process,h=l.setImmediate,d=l.clearImmediate,p=l.MessageChannel,g=0,v={},m="onreadystatechange",y=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},_=function(e){y.call(e.data)};h&&d||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),t)},i(g),g},d=function(e){delete v[e]},"process"==n(16)(f)?i=function(e){f.nextTick(a(y,e,1))}:p?(o=new p,r=o.port2,o.port1.onmessage=_,i=a(r.postMessage,r,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(i=function(e){l.postMessage(e+"","*")},l.addEventListener("message",_,!1)):i=m in c("script")?function(e){u.appendChild(c("script"))[m]=function(){u.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:h,clear:d}},function(e,t,n){var i=n(27),o=Math.min;e.exports=function(e){return e>0?o(i(e),9007199254740991):0}},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(9),a=i(r),s=n(84),u=i(s);t.default={getActions:function(){return{main:this._mainAction(),shape:this._shapeAction(),crop:this._cropAction(),flip:this._flipAction(),rotate:this._rotateAction(),text:this._textAction(),mask:this._maskAction(),draw:this._drawAction(),icon:this._iconAction(),filter:this._filterAction()}},_mainAction:function(){var e=this,t=function(){"crop"===e.ui.submenu&&(e.stopDrawingMode(),e.ui.changeMenu("crop"))};return(0,o.extend)({initLoadImage:function(n,i){return e.loadImageFromURL(n,i).then(function(i){t(),e.ui.initializeImgUrl=n,e.ui.resizeEditor({imageSize:i}),e.clearUndoStack()})},undo:function(){e.isEmptyUndoStack()||(t(),e.undo())},redo:function(){e.isEmptyRedoStack()||(t(),e.redo())},reset:function(){t(),e.loadImageFromURL(e.ui.initializeImgUrl,"resetImage").then(function(n){t(),e.ui.resizeEditor({imageSize:n}),e.clearUndoStack()})},delete:function(){e.ui.changeDeleteButtonEnabled(!1),t(),e.removeActiveObject(),e.activeObjectId=null},deleteAll:function(){t(),e.clearObjects(),e.ui.changeDeleteButtonEnabled(!1),e.ui.changeDeleteAllButtonEnabled(!1)},load:function(n){a.default.isSupportFileApi()||alert("This browser does not support file-api"),e.ui.initializeImgUrl=URL.createObjectURL(n),e.loadImageFromFile(n).then(function(n){t(),e.clearUndoStack(),e.ui.activeMenuEvent(),e.ui.resizeEditor({imageSize:n})}).catch(function(e){return Promise.reject(e)})},download:function(){var t=e.toDataURL(),n=e.getImageName(),i=void 0,o=void 0,r=void 0;a.default.isSupportFileApi()&&window.saveAs?(i=a.default.base64ToBlob(t),o=i.type.split("/")[1],n.split(".").pop()!==o&&(n+="."+o),saveAs(i,n)):(r=window.open(),r.document.body.innerHTML="<img src='"+t+"'>")}},this._commonAction())},_iconAction:function(){var e=this,t=void 0,n=void 0,i=void 0,r=void 0,a=void 0,s=void 0,c=void 0;this.on({iconCreateResize:function(t){var n=t.moveOriginPointer,o=(n.x-i)/a,u=(n.y-r)/s;e.setObjectPropertiesQuietly(c,{scaleX:Math.abs(2*o),scaleY:Math.abs(2*u)})},iconCreateEnd:function(){e.ui.icon.clearIconType(),e.changeSelectableAll(!0)}});var l=function(o,u){i=u.x,r=u.y,e.addIcon(t,{left:u.x,top:u.y,fill:n}).then(function(e){c=e.id,a=e.width,s=e.height})};return(0,o.extend)({changeColor:function(t){e.activeObjectId&&e.changeIconColor(e.activeObjectId,t)},addIcon:function(i,o){t=i,n=o,e.changeCursor("crosshair"),e.off("mousedown"),e.once("mousedown",l.bind(e))},cancelAddIcon:function(){e.off("mousedown"),e.ui.icon.clearIconType(),e.changeSelectableAll(!0),e.changeCursor("default")},registDefalutIcons:function(t,n){var i={};i[t]=n,e.registerIcons(i)},registCustomIcon:function(t,n){var i=new u.default;i.imageToSVG(t,function(t){var i=t.match(/path[^>]*d="([^"]*)"/),o=i[1],r={};r[n.name]=o,e.registerIcons(r),e.addIcon(n.name,{left:100,top:100})},u.default.tracerDefaultOption())}},this._commonAction())},_drawAction:function(){var e=this;return(0,o.extend)({setDrawMode:function(t,n){e.stopDrawingMode(),"free"===t?e.startDrawingMode("FREE_DRAWING",n):e.startDrawingMode("LINE_DRAWING",n)},setColor:function(t){e.setBrush({color:t})}},this._commonAction())},_maskAction:function(){var e=this;return(0,o.extend)({loadImageFromURL:function(t,n){return e.loadImageFromURL(e.toDataURL(),"FilterImage").then(function(){e.addImageObject(t).then(function(){URL.revokeObjectURL(n)})})},applyFilter:function(){e.applyFilter("mask",{maskObjId:e.activeObjectId})}},this._commonAction())},_textAction:function(){var e=this;return(0,o.extend)({changeTextStyle:function(t){e.activeObjectId&&e.changeTextStyle(e.activeObjectId,t)}},this._commonAction())},_rotateAction:function(){var e=this;return(0,o.extend)({rotate:function(t){e.rotate(t),e.ui.resizeEditor()},setAngle:function(t){e.setAngle(t),e.ui.resizeEditor()}},this._commonAction())},_shapeAction:function(){var e=this;return(0,o.extend)({changeShape:function(t){e.activeObjectId&&e.changeShape(e.activeObjectId,t)},setDrawingShape:function(t){e.setDrawingShape(t)}},this._commonAction())},_cropAction:function(){var e=this;return(0,o.extend)({crop:function(){var t=e.getCropzoneRect();t&&e.crop(t).then(function(){e.stopDrawingMode(),e.ui.resizeEditor(),e.ui.changeMenu("crop")}).catch(function(e){return Promise.reject(e)})},cancel:function(){e.stopDrawingMode(),e.ui.changeMenu("crop")},preset:function(t){switch(t){case"preset-square":e.setCropzoneRect(1);break;case"preset-3-2":e.setCropzoneRect(1.5);break;case"preset-4-3":e.setCropzoneRect(4/3);break;case"preset-5-4":e.setCropzoneRect(5/4);break;case"preset-7-5":e.setCropzoneRect(1.4);break;case"preset-16-9":e.setCropzoneRect(16/9);break;default:e.setCropzoneRect(),e.ui.crop.changeApplyButtonStatus(!1)}}},this._commonAction())},_flipAction:function(){var e=this;return(0,o.extend)({flip:function(t){return e[t]()}},this._commonAction())},_filterAction:function(){var e=this;return(0,o.extend)({applyFilter:function(t,n,i){t?e.applyFilter(n,i):e.hasFilter(n)&&e.removeFilter(n)}},this._commonAction())},setReAction:function(){var e=this;this.on({undoStackChanged:function(t){t?(e.ui.changeUndoButtonStatus(!0),e.ui.changeResetButtonStatus(!0)):(e.ui.changeUndoButtonStatus(!1),e.ui.changeResetButtonStatus(!1)),e.ui.resizeEditor()},redoStackChanged:function(t){t?e.ui.changeRedoButtonStatus(!0):e.ui.changeRedoButtonStatus(!1),e.ui.resizeEditor()},objectActivated:function(t){e.activeObjectId=t.id,e.ui.changeDeleteButtonEnabled(!0),e.ui.changeDeleteAllButtonEnabled(!0),"cropzone"===t.type?e.ui.crop.changeApplyButtonStatus(!0):["rect","circle","triangle"].indexOf(t.type)>-1?(e.stopDrawingMode(),"shape"!==e.ui.submenu&&e.ui.changeMenu("shape",!1,!1),e.ui.shape.setShapeStatus({strokeColor:t.stroke,strokeWidth:t.strokeWidth,fillColor:t.fill}),e.ui.shape.setMaxStrokeValue(Math.min(t.width,t.height))):"path"===t.type||"line"===t.type?"draw"!==e.ui.submenu&&(e.ui.changeMenu("draw",!1,!1),e.ui.draw.changeStandbyMode()):["i-text","text"].indexOf(t.type)>-1?"text"!==e.ui.submenu&&e.ui.changeMenu("text",!1,!1):"icon"===t.type&&(e.stopDrawingMode(),"icon"!==e.ui.submenu&&e.ui.changeMenu("icon",!1,!1),e.ui.icon.setIconPickerColor(t.fill))},addText:function(t){e.addText("Double Click",{position:t.originPosition,styles:{fill:e.ui.text.textColor,fontSize:a.default.toInteger(e.ui.text.fontSize),fontFamily:"Noto Sans"}}).then(function(){e.changeCursor("default")})},addObjectAfter:function(t){["rect","circle","triangle"].indexOf(t.type)>-1&&(e.ui.shape.setMaxStrokeValue(Math.min(t.width,t.height)),e.ui.shape.changeStandbyMode())},objectScaled:function(t){if(["i-text","text"].indexOf(t.type)>-1)e.ui.text.fontSize=a.default.toInteger(t.fontSize);else if(["rect","circle","triangle"].indexOf(t.type)>=0){var n=t.width,i=t.height,o=e.ui.shape.getStrokeValue();n<o&&e.ui.shape.setStrokeValue(n),i<o&&e.ui.shape.setStrokeValue(i)}},selectionCleared:function(){e.activeObjectId=null,"text"===e.ui.submenu?e.changeCursor("text"):"draw"!==e.ui.submenu&&"crop"!==e.ui.submenu&&e.stopDrawingMode()}})},_commonAction:function(){var e=this;return{modeChange:function(t){switch(t){case"text":e._changeActivateMode("TEXT");break;case"crop":e.startDrawingMode("CROPPER");break;case"shape":e._changeActivateMode("SHAPE"),e.setDrawingShape(e.ui.shape.type,e.ui.shape.options)}},deactivateAll:this.deactivateAll.bind(this),changeSelectableAll:this.changeSelectableAll.bind(this),discardSelection:this.discardSelection.bind(this),stopDrawingMode:this.stopDrawingMode.bind(this)}},mixin:function(e){(0,o.extend)(e.prototype,this)}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.componentNames,f=c.default.commandNames,h=l.ICON,d={name:f.ADD_ICON,execute:function(e,t,n){var i=this,o=e.getComponent(h);return this.undoData&&this.undoData.object?(e.add(this.undoData.object),s.default.resolve(this.undoData.object)):o.add(t,n).then(function(t){return i.undoData.object=e.getObject(t.id),t})},undo:function(e){return e.remove(this.undoData.object),s.default.resolve()}};r.default.register(d),e.exports=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.commandNames,f={name:l.ADD_IMAGE_OBJECT,execute:function(e,t){var n=this;return e.addImageObject(t).then(function(t){return n.undoData.object=e.getObject(t.id),t})},undo:function(e){return e.remove(this.undoData.object),s.default.resolve()}};r.default.register(f),e.exports=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.commandNames,f=c.default.rejectMessages,h={name:l.ADD_OBJECT,execute:function(e,t){return new s.default(function(n,i){e.contains(t)?i(f.addedObject):(e.add(t),n(t))})},undo:function(e,t){return new s.default(function(n,i){e.contains(t)?(e.remove(t),n(t)):i(f.noObject)})}};r.default.register(h),e.exports=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.componentNames,f=c.default.commandNames,h=l.SHAPE,d={name:f.ADD_SHAPE,execute:function(e,t,n){var i=this,o=e.getComponent(h);return o.add(t,n).then(function(t){return i.undoData.object=e.getObject(t.id),t})},undo:function(e){return e.remove(this.undoData.object),s.default.resolve()}};r.default.register(d),e.exports=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.componentNames,f=c.default.commandNames,h=l.TEXT,d={name:f.ADD_TEXT,execute:function(e,t,n){var i=this,o=e.getComponent(h);return this.undoData&&this.undoData.object?(e.add(this.undoData.object),s.default.resolve(this.undoData.object)):o.add(t,n).then(function(t){return i.undoData.object=e.getObject(t.id),t})},undo:function(e){return e.remove(this.undoData.object),s.default.resolve()}};r.default.register(d),e.exports=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(1),s=i(a),u=s.default.componentNames,c=s.default.rejectMessages,l=s.default.commandNames,f=u.FILTER,h={name:l.APPLY_FILTER,execute:function(e,t,n){var i=e.getComponent(f);if("mask"===t){var o=e.getObject(n.maskObjId);if(!o||!o.isType("image"))return Promise.reject(c.invalidParameters);n={mask:o}}return"mask"===t?(this.undoData.object=n.mask,e.remove(n.mask)):this.undoData.options=i.getOptions(t),i.add(t,n)},undo:function(e,t){var n=e.getComponent(f);if("mask"===t){var i=this.undoData.object;return e.add(i),e.setActiveObject(i),n.remove(t)}return this.undoData.options?n.add(t,this.undoData.options):n.remove(t)}};r.default.register(h),e.exports=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.componentNames,f=c.default.rejectMessages,h=c.default.commandNames,d=l.ICON,p={
name:h.CHANGE_ICON_COLOR,execute:function(e,t,n){var i=this;return new s.default(function(o,r){var a=e.getComponent(d),s=e.getObject(t);s||r(f.noObject),i.undoData.object=s,i.undoData.color=a.getColor(s),a.setColor(n,s),o()})},undo:function(e){var t=e.getComponent(d),n=this.undoData.object,i=n.object,o=n.color;return t.setColor(o,i),s.default.resolve()}};r.default.register(p),e.exports=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(4),r=i(o),a=n(3),s=i(a),u=n(2),c=i(u),l=n(1),f=i(l),h=f.default.componentNames,d=f.default.rejectMessages,p=f.default.commandNames,g=h.SHAPE,v={name:p.CHANGE_SHAPE,execute:function(e,t,n){var i=this,o=e.getComponent(g),a=e.getObject(t);return a?(this.undoData.object=a,this.undoData.options={},r.default.forEachOwnProperties(n,function(e,t){i.undoData.options[t]=a[t]}),o.change(a,n)):c.default.reject(d.noObject)},undo:function(e){var t=e.getComponent(g),n=this.undoData,i=n.object,o=n.options;return t.change(i,o)}};s.default.register(v),e.exports=v},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.componentNames,f=c.default.rejectMessages,h=c.default.commandNames,d=l.TEXT,p={name:h.CHANGE_TEXT,execute:function(e,t,n){var i=e.getComponent(d),o=e.getObject(t);return o?(this.undoData.object=o,this.undoData.text=i.getText(o),i.change(o,n)):s.default.reject(f.noObject)},undo:function(e){var t=e.getComponent(d),n=this.undoData,i=n.object,o=n.text;return t.change(i,o)}};r.default.register(p),e.exports=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(4),r=i(o),a=n(3),s=i(a),u=n(2),c=i(u),l=n(1),f=i(l),h=f.default.componentNames,d=f.default.rejectMessages,p=f.default.commandNames,g=h.TEXT,v={name:p.CHANGE_TEXT_STYLE,execute:function(e,t,n){var i=this,o=e.getComponent(g),a=e.getObject(t);return a?(this.undoData.object=a,this.undoData.styles={},r.default.forEachOwnProperties(n,function(e,t){i.undoData.styles[t]=a[t]}),o.setStyle(a,n)):c.default.reject(d.noObject)},undo:function(e){var t=e.getComponent(g),n=this.undoData,i=n.object,o=n.styles;return t.setStyle(i,o)}};s.default.register(v),e.exports=v},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.commandNames,f={name:l.CLEAR_OBJECTS,execute:function(e){var t=this;return new s.default(function(n){t.undoData.objects=e.removeAll(),n()})},undo:function(e){return e.add(this.undoData.objects),s.default.resolve()}};r.default.register(f),e.exports=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(1),s=i(a),u=s.default.componentNames,c=s.default.commandNames,l=u.FLIP,f={name:c.FLIP_IMAGE,execute:function(e,t){var n=e.getComponent(l);return this.undoData.setting=n.getCurrentSetting(),n[t]()},undo:function(e){var t=e.getComponent(l);return t.set(this.undoData.setting)}};r.default.register(f),e.exports=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(1),s=i(a),u=s.default.componentNames,c=s.default.commandNames,l=u.IMAGE_LOADER,f={name:c.LOAD_IMAGE,execute:function(e,t,n){var i=e.getComponent(l),o=i.getCanvasImage(),r=o?o.width:0,a=o?o.height:0,s=e.removeAll(!0).filter(function(e){return"cropzone"!==e.type});return s.forEach(function(e){e.evented=!0}),this.undoData={name:i.getImageName(),image:o,objects:s},i.load(t,n).then(function(e){return{oldWidth:r,oldHeight:a,newWidth:e.width,newHeight:e.height}})},undo:function(e){var t=e.getComponent(l),n=this.undoData,i=n.objects,o=n.name,r=n.image;return e.removeAll(!0),e.add(i),t.load(o,r)}};r.default.register(f),e.exports=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(1),s=i(a),u=s.default.componentNames,c=s.default.commandNames,l=u.FILTER,f={name:c.REMOVE_FILTER,execute:function(e,t){var n=e.getComponent(l);return this.undoData.options=n.getOptions(t),n.remove(t)},undo:function(e,t){var n=e.getComponent(l),i=this.undoData.options;return n.add(t,i)}};r.default.register(f),e.exports=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.commandNames,f=c.default.rejectMessages,h={name:l.REMOVE_OBJECT,execute:function(e,t){var n=this;return new s.default(function(i,o){n.undoData.objects=e.removeObjectById(t),n.undoData.objects.length?i():o(f.noObject)})},undo:function(e){return e.add(this.undoData.objects),s.default.resolve()}};r.default.register(h),e.exports=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.commandNames,f={name:l.RESIZE_CANVAS_DIMENSION,execute:function(e,t){var n=this;return new s.default(function(i){n.undoData.size={width:e.cssMaxWidth,height:e.cssMaxHeight},e.setCssMaxDimension(t),e.adjustCanvasDimension(),i()})},undo:function(e){return e.setCssMaxDimension(this.undoData.size),e.adjustCanvasDimension(),s.default.resolve()}};r.default.register(f),e.exports=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(1),s=i(a),u=s.default.componentNames,c=s.default.commandNames,l=u.ROTATION,f={name:c.ROTATE_IMAGE,execute:function(e,t,n){var i=e.getComponent(l);return this.undoData.angle=i.getCurrentAngle(),i[t](n)},undo:function(e){var t=e.getComponent(l),n=this.undoData.angle;return t.setAngle(n)}};r.default.register(f),e.exports=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(3),r=i(o),a=n(2),s=i(a),u=n(1),c=i(u),l=c.default.commandNames,f=c.default.rejectMessages,h={name:l.SET_OBJECT_POSITION,execute:function(e,t,n){var i=e.getObject(t);return i?(this.undoData.objectId=t,this.undoData.props=e.getObjectProperties(t,["left","top"]),e.setObjectPosition(t,n),e.renderAll(),s.default.resolve()):s.default.reject(f.noObject)},undo:function(e){var t=this.undoData,n=t.objectId,i=t.props;return e.setObjectProperties(n,i),e.renderAll(),s.default.resolve()}};r.default.register(h),e.exports=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(4),r=i(o),a=n(3),s=i(a),u=n(2),c=i(u),l=n(1),f=i(l),h=f.default.commandNames,d=f.default.rejectMessages,p={name:h.SET_OBJECT_PROPERTIES,execute:function(e,t,n){var i=this,o=e.getObject(t);return o?(this.undoData&&!this.undoData.props&&o.originalState&&(this.undoData.props={},r.default.forEachOwnProperties(n,function(e,t){i.undoData.props[t]=o.originalState[t]})),e.setObjectProperties(t,n),c.default.resolve()):c.default.reject(d.noObject)},undo:function(e,t){var n=this.undoData.props;return e.setObjectProperties(t,n),c.default.resolve()}};s.default.register(p),e.exports=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(4),c=i(u),l=n(5),f=i(l),h=n(7),d=i(h),p=n(79),g=i(p),v=n(1),m=n(9),y=10,_={top:-10,left:-10,height:1,width:1},b=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,v.componentNames.CROPPER,e));return n._cropzone=null,n._startX=null,n._startY=null,n._withShiftKey=!1,n._listeners={keydown:n._onKeyDown.bind(n),keyup:n._onKeyUp.bind(n),mousedown:n._onFabricMouseDown.bind(n),mousemove:n._onFabricMouseMove.bind(n),mouseup:n._onFabricMouseUp.bind(n)},n}return a(t,e),s(t,[{key:"start",value:function(){if(!this._cropzone){var e=this.getCanvas();e.forEachObject(function(e){e.evented=!1}),this._cropzone=new g.default({left:-10,top:-10,width:1,height:1,strokeWidth:0,cornerSize:10,cornerColor:"black",fill:"transparent",hasRotatingPoint:!1,hasBorders:!1,lockScalingFlip:!0,lockRotation:!0},this.graphics.cropSelectionStyle),e.deactivateAll(),e.add(this._cropzone),e.on("mouse:down",this._listeners.mousedown),e.selection=!1,e.defaultCursor="crosshair",f.default.util.addListener(document,"keydown",this._listeners.keydown),f.default.util.addListener(document,"keyup",this._listeners.keyup)}}},{key:"end",value:function(){var e=this.getCanvas(),t=this._cropzone;t&&(t.remove(),e.selection=!0,e.defaultCursor="default",e.off("mouse:down",this._listeners.mousedown),e.forEachObject(function(e){e.evented=!0}),this._cropzone=null,f.default.util.removeListener(document,"keydown",this._listeners.keydown),f.default.util.removeListener(document,"keyup",this._listeners.keyup))}},{key:"_onFabricMouseDown",value:function(e){var t=this.getCanvas();if(!e.target){t.selection=!1;var n=t.getPointer(e.e);this._startX=n.x,this._startY=n.y,t.on({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup})}}},{key:"_onFabricMouseMove",value:function(e){var t=this.getCanvas(),n=t.getPointer(e.e),i=n.x,o=n.y,r=this._cropzone;Math.abs(i-this._startX)+Math.abs(o-this._startY)>y&&(r.remove(),r.set(this._calcRectDimensionFromPoint(i,o)),t.add(r))}},{key:"_calcRectDimensionFromPoint",value:function(e,t){var n=this.getCanvas(),i=n.getZoom(),o=n.getWidth()/i,r=n.getHeight()/i,a=this._startX,s=this._startY,u=(0,m.clamp)(e,0,a),c=(0,m.clamp)(t,0,s),l=(0,m.clamp)(e,a,o)-u,f=(0,m.clamp)(t,s,r)-c;return this._withShiftKey&&(l>f?f=l:f>l&&(l=f),a>=e&&(u=a-l),s>=t&&(c=s-f)),{left:u,top:c,width:l,height:f}}},{key:"_onFabricMouseUp",value:function(){var e=this._cropzone,t=this._listeners,n=this.getCanvas();n.setActiveObject(e),n.off({"mouse:move":t.mousemove,"mouse:up":t.mouseup})}},{key:"getCroppedImageData",value:function(e){var t=this.getCanvas(),n=t.contains(this._cropzone);if(!e)return null;n&&this._cropzone.remove();var i={imageName:this.getImageName(),url:t.toDataURL(e)};return n&&t.add(this._cropzone),i}},{key:"getCropzoneRect",value:function(){var e=this._cropzone;return e.isValid()?{left:e.getLeft(),top:e.getTop(),width:e.getWidth(),height:e.getHeight()}:null}},{key:"setCropzoneRect",value:function(e){var t=this.getCanvas(),n=this._cropzone;t.deactivateAll(),t.selection=!1,n.remove(),n.set(e?this._getPresetCropSizePosition(e):_),t.add(n),t.selection=!0,e&&t.setActiveObject(n)}},{key:"_getPresetCropSizePosition",value:function(e){var t=this.getCanvas(),n=t.getWidth(),i=t.getHeight(),o=n>=i?n:i,r=function(e,t){return e>t?t/e:1},a=o*e,s=o,u=r(a,n),l=c.default.map([a,s],function(e){return e*u});a=l[0],s=l[1];var f=r(s,i),h=c.default.map([a,s],function(e){return e*f});return a=h[0],s=h[1],{top:(i-s)/2,left:(n-a)/2,width:a,height:s}}},{key:"_onKeyDown",value:function(e){e.keyCode===v.keyCodes.SHIFT&&(this._withShiftKey=!0)}},{key:"_onKeyUp",value:function(e){e.keyCode===v.keyCodes.SHIFT&&(this._withShiftKey=!1)}}]),t}(d.default);e.exports=b},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(4),c=n(2),l=i(c),f=n(5),h=i(f),d=n(7),p=i(d),g=n(81),v=i(g),m=n(1),y=i(m),_=n(77),b=i(_),O=n(82),k=i(O),x=n(80),w=i(x),C=n(78),E=i(C),j=y.default.rejectMessages,M=h.default.Image.filters;M.Mask=v.default,M.Blur=b.default,M.Sharpen=k.default,M.Emboss=w.default,M.ColorFilter=E.default;var S=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,y.default.componentNames.FILTER,e))}return a(t,e),s(t,[{key:"add",value:function(e,t){var n=this;return new l.default(function(i,o){var r=n._getSourceImage(),a=n.getCanvas(),s=n._getFilter(r,e);s||(s=n._createFilter(r,e,t)),s||o(j.invalidParameters),n._changeFilterValues(s,t),n._apply(r,function(){a.renderAll(),i({type:e,action:"add"})})})}},{key:"remove",value:function(e){var t=this;return new l.default(function(n,i){var o=t._getSourceImage(),r=t.getCanvas();o.filters.length||i(j.unsupportedOperation),t._removeFilter(o,e),t._apply(o,function(){r.renderAll(),n({type:e,action:"remove"})})})}},{key:"hasFilter",value:function(e){return!!this._getFilter(this._getSourceImage(),e)}},{key:"getOptions",value:function(e){var t=this._getSourceImage(),n=this._getFilter(t,e);return n?(0,u.extend)({},n.options):null}},{key:"_changeFilterValues",value:function(e,t){(0,u.forEach)(t,function(t,n){(0,u.isUndefined)(e[n])||(e[n]=t)}),(0,u.forEach)(e.options,function(n,i){(0,u.isUndefined)(t[i])||(e.options[i]=t[i])})}},{key:"_apply",value:function(e,t){e.applyFilters(t)}},{key:"_getSourceImage",value:function(){return this.getCanvasImage()}},{key:"_createFilter",value:function(e,t,n){var i=void 0,o=this._getFabricFilterType(t),r=h.default.Image.filters[o];return r&&(i=new r(n),i.options=n,e.filters.push(i)),i}},{key:"_getFilter",value:function(e,t){var n=null;if(e){var i=this._getFabricFilterType(t),o=e.filters.length,r=void 0,a=void 0;for(a=0;a<o;a+=1)if(r=e.filters[a],r.type===i){n=r;break}}return n}},{key:"_removeFilter",value:function(e,t){var n=this._getFabricFilterType(t);e.filters=(0,u.filter)(e.filters,function(e){return e.type!==n})}},{key:"_getFabricFilterType",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}]),t}(p.default);e.exports=S},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(4),c=i(u),l=n(2),f=i(l),h=n(7),d=i(h),p=n(1),g=i(p),v=g.default.componentNames,m=g.default.rejectMessages,y=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,v.FLIP,e))}return a(t,e),s(t,[{key:"getCurrentSetting",value:function(){var e=this.getCanvasImage();return{flipX:e.flipX,flipY:e.flipY}}},{key:"set",value:function(e){var t=this.getCurrentSetting(),n=t.flipX!==e.flipX,i=t.flipY!==e.flipY;return n||i?(c.default.extend(t,e),this.setImageProperties(t,!0),this._invertAngle(n,i),this._flipObjects(n,i),f.default.resolve({flipX:t.flipX,flipY:t.flipY,angle:this.getCanvasImage().angle})):f.default.reject(m.flip)}},{key:"_invertAngle",value:function(e,t){var n=this.getCanvasImage(),i=n.angle;e&&(i*=-1),t&&(i*=-1),n.setAngle(parseFloat(i)).setCoords()}},{key:"_flipObjects",value:function(e,t){var n=this.getCanvas();e&&n.forEachObject(function(e){e.set({angle:parseFloat(e.angle*-1),flipX:!e.flipX,left:n.width-e.left}).setCoords()}),t&&n.forEachObject(function(e){e.set({angle:parseFloat(e.angle*-1),flipY:!e.flipY,top:n.height-e.top}).setCoords()}),n.renderAll()}},{key:"reset",value:function(){return this.set({flipX:!1,flipY:!1})}},{key:"flipX",value:function(){var e=this.getCurrentSetting();return this.set({flipX:!e.flipX,flipY:e.flipY})}},{key:"flipY",value:function(){var e=this.getCurrentSetting();return this.set({flipX:e.flipX,flipY:!e.flipY})}}]),t}(d.default);e.exports=y},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(5),c=i(u),l=n(7),f=i(l),h=n(1),d=i(h),p=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,d.default.componentNames.FREE_DRAWING,e));return n.width=12,n.oColor=new c.default.Color("rgba(0, 0, 0, 0.5)"),n._listeners={mousedown:n._onFabricMouseDown.bind(n),mouseup:n._onFabricMouseUp.bind(n)},n}return a(t,e),s(t,[{key:"start",value:function(e){var t=this.getCanvas();t.isDrawingMode=!0,this.setBrush(e),t.on({"mouse:down":this._listeners.mousedown})}},{key:"setBrush",value:function(e){var t=this.getCanvas().freeDrawingBrush;e=e||{},this.width=e.width||this.width,e.color&&(this.oColor=new c.default.Color(e.color)),t.width=this.width,t.color=this.oColor.toRgba()}},{key:"end",value:function(){var e=this.getCanvas();e.isDrawingMode=!1,e.off("mouse:down",this._listeners.mousedown)}},{key:"_onFabricMouseDown",value:function(){var e=this.getCanvas();e.isDrawingMode=!0,e.on({"mouse:up":this._listeners.mouseup})}},{key:"_onFabricMouseUp",value:function(e){var t=this.getCanvas(),n=t.findTarget(e.e);n&&(n.set({perPixelTargetFind:!1}),t.setActiveObject(n)),t.off({"mouse:up":this._listeners.mouseup}),t.isDrawingMode=!1}}]),t}(f.default);e.exports=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(5),c=i(u),l=n(4),f=i(l),h=n(2),d=i(h),p=n(7),g=i(p),v=n(1),m=i(v),y=m.default.eventNames,_=m.default.rejectMessages,b={arrow:"M 0 9 H 11 V 12 L 18 7 L 11 2 V 5 H 0 Z",arrow2:"M 0 90 H 105 V 120 L 160 60 L 105 0 V 30 H 0 Z",cancel:"M 0 30 L 30 60 L 0 90 L 30 120 L 60 90 L 90 120 L 120 90 L 90 60 L 120 30 L 90 0 L 60 30 L 30 0 Z"},O=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m.default.componentNames.ICON,e));return n._oColor="#000000",n._pathMap=b,n.useDragAddIcon=e.useDragAddIcon,n}return a(t,e),s(t,[{key:"add",value:function(e,t){var n=this;return new d.default(function(i,o){var r=n.getCanvas(),a=n._pathMap[e],s=m.default.fObjectOptions.SELECTION_STYLE,u=a?n._createIcon(a):null;u||o(_.invalidParameters),u.set(f.default.extend({type:"icon",fill:n._oColor},s,t,n.graphics.controlStyle)),r.add(u).setActiveObject(u),n.useDragAddIcon&&n._addWithDragEvent(r),i(n.graphics.createObjectProperties(u))})}},{key:"_addWithDragEvent",value:function(e){var t=this.fire.bind(this),n=0,i=function(n){e.selection=!1,t(y.ICON_CREATE_RESIZE,{moveOriginPointer:e.getPointer(n.e)})},o=0,r=function(i){t(y.ICON_CREATE_END,{moveOriginPointer:e.getPointer(i.e)}),e.selection=!0,e.defaultCursor="default",e.off("mouse:up",o),e.off("mouse:move",n)};o=r.bind(this),n=i.bind(this),e.on({"mouse:move":n,"mouse:up":o})}},{key:"registerPaths",value:function(e){var t=this;f.default.forEach(e,function(e,n){t._pathMap[n]=e},this)}},{key:"setColor",value:function(e,t){this._oColor=e,t&&"icon"===t.get("type")&&(t.setFill(this._oColor),this.getCanvas().renderAll())}},{key:"getColor",value:function(e){return e.fill}},{key:"_createIcon",value:function(e){return new c.default.Path(e)}}]),t}(g.default);e.exports=O},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(2),c=i(u),l=n(7),f=i(l),h=n(1),d=i(h),p=d.default.componentNames,g=d.default.rejectMessages,v={padding:0,crossOrigin:"Anonymous"},m=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,p.IMAGE_LOADER,e))}return a(t,e),s(t,[{key:"load",value:function(e,t){var n=this,i=void 0;if(e||t)i=this._setBackgroundImage(t).then(function(t){return n.setCanvasImage(e,t),n.adjustCanvasDimension(),t});else{var o=this.getCanvas();o.backgroundImage=null,o.renderAll(),i=new c.default(function(e){n.setCanvasImage("",null),e()})}return i}},{key:"_setBackgroundImage",value:function(e){var t=this;return e?new c.default(function(n,i){var o=t.getCanvas();o.setBackgroundImage(e,function(){var e=o.backgroundImage;e&&e.getElement()?n(e):i(g.loadingImageFailed)},v)}):c.default.reject(g.loadImage)}}]),t}(f.default);e.exports=m},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(5),c=i(u),l=n(7),f=i(l),h=n(1),d=i(h),p=d.default.eventNames,g=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,d.default.componentNames.LINE,e));return n._width=12,n._oColor=new c.default.Color("rgba(0, 0, 0, 0.5)"),n._listeners={mousedown:n._onFabricMouseDown.bind(n),mousemove:n._onFabricMouseMove.bind(n),mouseup:n._onFabricMouseUp.bind(n)},n}return a(t,e),s(t,[{key:"start",value:function(e){var t=this.getCanvas();t.defaultCursor="crosshair",t.selection=!1,this.setBrush(e),t.forEachObject(function(e){e.set({evented:!1})}),t.on({"mouse:down":this._listeners.mousedown})}},{key:"setBrush",value:function(e){var t=this.getCanvas().freeDrawingBrush;e=e||{},this._width=e.width||this._width,e.color&&(this._oColor=new c.default.Color(e.color)),t.width=this._width,t.color=this._oColor.toRgba()}},{key:"end",value:function(){var e=this.getCanvas();e.defaultCursor="default",e.selection=!0,e.forEachObject(function(e){e.set({evented:!0})}),e.off("mouse:down",this._listeners.mousedown)}},{key:"_onFabricMouseDown",value:function(e){var t=this.getCanvas(),n=t.getPointer(e.e),i=[n.x,n.y,n.x,n.y];this._line=new c.default.Line(i,{stroke:this._oColor.toRgba(),strokeWidth:this._width,evented:!1,perPixelTargetFind:!0,targetFindTolerance:d.default.defaultPixelTargetTolerance}),this._line.set(d.default.fObjectOptions.SELECTION_STYLE),t.add(this._line),t.on({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup})}},{key:"_onFabricMouseMove",value:function(e){var t=this.getCanvas(),n=t.getPointer(e.e);this._line.set({x2:n.x,y2:n.y}),this._line.setCoords(),t.renderAll()}},{key:"_onFabricMouseUp",value:function(){var e=this.getCanvas(),t=this.graphics.createObjectProperties(this._line);this.fire(p.ADD_OBJECT,t),e.forEachObject(function(e){e.set({evented:!0})}),e.setActiveObject(this._line),this._line=null,e.off({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup})}}]),t}(f.default);e.exports=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(5),c=i(u),l=n(2),f=i(l),h=n(7),d=i(h),p=n(1),g=i(p),v=g.default.componentNames,m=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,v.ROTATION,e))}return a(t,e),s(t,[{key:"getCurrentAngle",value:function(){return this.getCanvasImage().angle}},{key:"setAngle",value:function(e){var t=this.getCurrentAngle()%360;e%=360;var n=this.getCanvasImage(),i=n.getCenterPoint();n.setAngle(e).setCoords(),this.adjustCanvasDimensionForRotate();var o=n.getCenterPoint();return this._rotateForEachObject(i,o,e-t),f.default.resolve(e)}},{key:"_rotateForEachObject",value:function(e,t,n){var i=this.getCanvas(),o={x:e.x-t.x,y:e.y-t.y};i.forEachObject(function(t){var i=t.getCenterPoint(),r=c.default.util.degreesToRadians(n),a=c.default.util.rotatePoint(i,e,r);t.set({left:a.x-o.x,top:a.y-o.y,angle:(t.angle+n)%360}),t.setCoords()}),i.renderAll()}},{key:"rotate",value:function(e){var t=this.getCurrentAngle();return this.setAngle(t+e)}}]),t}(d.default);e.exports=m},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(5),c=i(u),l=n(2),f=i(l),h=n(7),d=i(h),p=n(1),g=i(p),v=n(85),m=i(v),y=n(4),_=g.default.rejectMessages,b=g.default.eventNames,O=g.default.keyCodes,k="rect",x=20,w=20,C=5,E={strokeWidth:1,stroke:"#000000",fill:"#ffffff",width:1,height:1,rx:0,ry:0,lockSkewingX:!0,lockSkewingY:!0,lockUniScaling:!1,bringForward:!0,isRegular:!1},j=["rect","circle","triangle"],M=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,g.default.componentNames.SHAPE,e));return n._shapeObj=null,n._type=k,n._options=(0,y.extend)({},E),n._isSelected=!1,n._startPoint={},n._withShiftKey=!1,n._mouseMoved=!1,n._handlers={mousedown:n._onFabricMouseDown.bind(n),mousemove:n._onFabricMouseMove.bind(n),mouseup:n._onFabricMouseUp.bind(n),keydown:n._onKeyDown.bind(n),keyup:n._onKeyUp.bind(n)},n}return a(t,e),s(t,[{key:"start",value:function(){var e=this.getCanvas();this._isSelected=!1,e.defaultCursor="crosshair",e.selection=!1,e.uniScaleTransform=!0,e.forEachObject(function(e){e.set({evented:!1})}),e.on({"mouse:down":this._handlers.mousedown}),c.default.util.addListener(document,"keydown",this._handlers.keydown),c.default.util.addListener(document,"keyup",this._handlers.keyup)}},{key:"end",value:function(){var e=this.getCanvas();this._isSelected=!1,e.defaultCursor="default",e.selection=!0,e.uniScaleTransform=!1,e.off({"mouse:down":this._handlers.mousedown}),c.default.util.removeListener(document,"keydown",this._handlers.keydown),c.default.util.removeListener(document,"keyup",this._handlers.keyup)}},{key:"setStates",value:function(e,t){this._type=e,t&&(this._options=(0,y.extend)(this._options,t))}},{key:"add",value:function(e,t){var n=this;return new f.default(function(i){var o=n.getCanvas();t=n._extendOptions(t);var r=n._createInstance(e,t);n._bindEventOnShape(r),o.add(r).setActiveObject(r);var a=n.graphics.createObjectProperties(r);i(a)})}},{key:"change",value:function(e,t){var n=this;return new f.default(function(i,o){(0,y.inArray)(e.get("type"),j)<0&&o(_.unsupportedType),e.set(t),n.getCanvas().renderAll(),i()})}},{key:"_createInstance",value:function(e,t){var n=void 0;switch(e){case"rect":n=new c.default.Rect(t);break;case"circle":n=new c.default.Ellipse((0,y.extend)({type:"circle"},t));break;case"triangle":n=new c.default.Triangle(t);break;default:n={}}return n}},{key:"_extendOptions",value:function(e){var t=g.default.fObjectOptions.SELECTION_STYLE;return e=(0,y.extend)({},E,this._options,t,e),e.isRegular&&(e.lockUniScaling=!0),e}},{key:"_bindEventOnShape",value:function(e){var t=this,n=this.getCanvas();e.on({added:function(){t._shapeObj=this,m.default.setOrigins(t._shapeObj)},selected:function(){t._isSelected=!0,t._shapeObj=this,n.uniScaleTransform=!0,n.defaultCursor="default",m.default.setOrigins(t._shapeObj)},deselected:function(){t._isSelected=!1,t._shapeObj=null,n.defaultCursor="crosshair",n.uniScaleTransform=!1},modified:function(){
var e=t._shapeObj;m.default.adjustOriginToCenter(e),m.default.setOrigins(e)},scaling:function(e){var i=n.getPointer(e.e),o=t._shapeObj;m.default.setOrigins(o),n.setCursor("crosshair"),m.default.resize(o,i,!0)}})}},{key:"_onFabricMouseDown",value:function(e){if(e.target||(this._isSelected=!1,this._shapeObj=!1),!this._isSelected&&!this._shapeObj){var t=this.getCanvas();this._startPoint=t.getPointer(e.e),t.on({"mouse:move":this._handlers.mousemove,"mouse:up":this._handlers.mouseup})}}},{key:"_onFabricMouseMove",value:function(e){var t=this,n=this.getCanvas(),i=n.getPointer(e.e),o=this._startPoint.x,r=this._startPoint.y,a=o-i.x,s=r-i.y,u=this._shapeObj;u?(this._shapeObj.set({isRegular:this._withShiftKey}),m.default.resize(u,i),n.renderAll()):Math.abs(a)>C&&Math.abs(s)>C&&(this._mouseMoved=!0,this.add(this._type,{left:o,top:r,width:a,height:s,perPixelTargetFind:!1}).then(function(e){t.fire(b.ADD_OBJECT,e)}))}},{key:"_onFabricMouseUp",value:function(){var e=this,t=this.getCanvas(),n=this._startPoint.x,i=this._startPoint.y,o=this._shapeObj;this._mouseMoved&&(o?o&&(m.default.adjustOriginToCenter(o),this.fire(b.ADD_OBJECT_AFTER,this.graphics.createObjectProperties(o))):this.add(this._type,{left:n,top:i,width:x,height:w,perPixelTargetFind:!1}).then(function(t){e.fire(b.ADD_OBJECT,t)}),this._mouseMoved=!1,t.defaultCursor="default",t.forEachObject(function(e){e.set({evented:!0})})),t.off({"mouse:move":this._handlers.mousemove,"mouse:up":this._handlers.mouseup})}},{key:"_onKeyDown",value:function(e){e.keyCode===O.SHIFT&&(this._withShiftKey=!0,this._shapeObj&&(this._shapeObj.isRegular=!0))}},{key:"_onKeyUp",value:function(e){e.keyCode===O.SHIFT&&(this._withShiftKey=!1,this._shapeObj&&(this._shapeObj.isRegular=!1))}}]),t}(d.default);e.exports=M},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(5),c=i(u),l=n(4),f=i(l),h=n(2),d=i(h),p=n(7),g=i(p),v=n(1),m=i(v),y=n(9),_=i(y),b=m.default.eventNames,O={fill:"#000000",left:0,top:0},k={fill:"#000000",fontStyle:"normal",fontWeight:"normal",textAlign:"left",textDecoraiton:""},x="tui-image-eidtor-textarea",w=_.default.makeStyleText({position:"absolute",padding:0,display:"none",border:"1px dotted red",overflow:"hidden",resize:"none",outline:"none","border-radius":0,"background-color":"transparent","-webkit-appearance":"none","z-index":9999,"white-space":"pre"}),C=.1,E=500,j=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m.default.componentNames.TEXT,e));return n._defaultStyles=O,n._isSelected=!1,n._selectedObj={},n._editingObj={},n._listeners={mousedown:n._onFabricMouseDown.bind(n),select:n._onFabricSelect.bind(n),selectClear:n._onFabricSelectClear.bind(n),scaling:n._onFabricScaling.bind(n)},n._textarea=null,n._ratio=1,n._lastClickTime=(new Date).getTime(),n._editingObjInfos={},n.isPrevEditing=!1,n.useItext=e.useItext,n}return a(t,e),s(t,[{key:"start",value:function(){var e=this.getCanvas();this.isPrevEditing=!1,e.selection=!1,e.defaultCursor="text",e.on({"mouse:down":this._listeners.mousedown,"object:selected":this._listeners.select,"before:selection:cleared":this._listeners.selectClear,"object:scaling":this._listeners.scaling,"text:editing":this._listeners.modify}),this.useItext?e.forEachObject(function(e){"i-text"===e.type}):this._createTextarea(),this.setCanvasRatio()}},{key:"end",value:function(){var e=this.getCanvas();e.selection=!0,e.defaultCursor="default",this.useItext?e.forEachObject(function(e){"i-text"===e.type&&""===e.text&&e.remove()}):(e.deactivateAllWithDispatch(),this._removeTextarea()),e.off({"mouse:down":this._listeners.mousedown,"object:selected":this._listeners.select,"before:selection:cleared":this._listeners.selectClear,"object:scaling":this._listeners.scaling,"text:editing":this._listeners.modify})}},{key:"add",value:function(e,t){var n=this;return new d.default(function(i){var o=n.getCanvas(),r=null,a=m.default.fObjectOptions.SELECTION_STYLE,s=n._defaultStyles;n._setInitPos(t.position),t.styles&&(s=f.default.extend(s,t.styles)),n.useItext?(r=new c.default.IText(e,s),a=f.default.extend({},a)):r=new c.default.Text(e,s),r.set(a),r.on({mouseup:n._onFabricMouseUp.bind(n)}),o.add(r),o.getActiveObject()||o.setActiveObject(r),n.isPrevEditing=!0,i(n.graphics.createObjectProperties(r))})}},{key:"change",value:function(e,t){var n=this;return new d.default(function(i){e.set("text",t),n.getCanvas().renderAll(),i()})}},{key:"setStyle",value:function(e,t){var n=this;return new d.default(function(i){f.default.forEach(t,function(n,i){e[i]===n&&(t[i]=k[i]||"")},n),e.set(t),n.getCanvas().renderAll(),i()})}},{key:"getText",value:function(e){return e.getText()}},{key:"setSelectedInfo",value:function(e,t){this._selectedObj=e,this._isSelected=t}},{key:"isSelected",value:function(){return this._isSelected}},{key:"getSelectedObj",value:function(){return this._selectedObj}},{key:"setCanvasRatio",value:function(){var e=this.getCanvasElement(),t=parseInt(e.style.maxWidth,10),n=e.width,i=n/t;this._ratio=i}},{key:"getCanvasRatio",value:function(){return this._ratio}},{key:"_setInitPos",value:function(e){e=e||this.getCanvasImage().getCenterPoint(),this._defaultStyles.left=e.x,this._defaultStyles.top=e.y}},{key:"_createTextarea",value:function(){var e=this.getCanvasElement().parentNode,t=document.createElement("textarea");t.className=x,t.setAttribute("style",w),t.setAttribute("wrap","off"),e.appendChild(t),this._textarea=t,this._listeners=f.default.extend(this._listeners,{input:this._onInput.bind(this),keydown:this._onKeyDown.bind(this),blur:this._onBlur.bind(this),scroll:this._onScroll.bind(this)}),c.default.util.addListener(t,"input",this._listeners.input),c.default.util.addListener(t,"blur",this._listeners.blur),c.default.util.addListener(t,"scroll",this._listeners.scroll)}},{key:"_removeTextarea",value:function(){var e=this.getCanvasElement().parentNode,t=e.querySelector("textarea");e.removeChild(t),this._textarea=null,c.default.util.removeListener(t,"input",this._listeners.input),c.default.util.removeListener(t,"blur",this._listeners.blur),c.default.util.removeListener(t,"scroll",this._listeners.scroll)}},{key:"_onInput",value:function(){var e=this.getCanvasRatio(),t=this._editingObj,n=this._textarea.style;n.width=Math.ceil(t.getWidth()/e)+"px",n.height=Math.ceil(t.getHeight()/e)+"px"}},{key:"_onKeyDown",value:function(){var e=this,t=this.getCanvasRatio(),n=this._editingObj,i=this._textarea.style;setTimeout(function(){n.setText(e._textarea.value),i.width=Math.ceil(n.getWidth()/t)+"px",i.height=Math.ceil(n.getHeight()/t)+"px"},0)}},{key:"_onBlur",value:function(){var e=this.getCanvasRatio(),t=this._editingObj,n=this._editingObjInfos,i=this._textarea.value,o=t.getWidth()/e-n.width/e,r=t.getHeight()/e-n.height/e;if(1===e&&(o/=2,r/=2),this._textarea.style.display="none",t.set({left:n.left+o,top:n.top+r}),i.length){this.getCanvas().add(t);var a={id:f.default.stamp(t),type:t.type,text:i};this.fire(b.TEXT_CHANGED,a)}}},{key:"_onScroll",value:function(){this._textarea.scrollLeft=0,this._textarea.scrollTop=0}},{key:"_onFabricScaling",value:function(e){var t=e.target,n=t.getFontSize()*t.getScaleY();t.setFontSize(n),t.setScaleX(1),t.setScaleY(1)}},{key:"_onFabricSelectClear",value:function(e){var t=this.getSelectedObj();this.isPrevEditing=!0,this.setSelectedInfo(e.target,!1),t&&""===t.text&&t.remove()}},{key:"_onFabricSelect",value:function(e){this.isPrevEditing=!0,this.setSelectedInfo(e.target,!0)}},{key:"_onFabricMouseDown",value:function(e){var t=e.target;if(!t||t.isType("text"))return this.isPrevEditing?void(this.isPrevEditing=!1):void this._fireAddText(e)}},{key:"_fireAddText",value:function(e){var t=e.target,n=e.e||{},i=this.getCanvas().getPointer(n);t||this.fire(b.ADD_TEXT,{originPosition:{x:i.x,y:i.y},clientPosition:{x:n.clientX||0,y:n.clientY||0}})}},{key:"_onFabricMouseUp",value:function(e){var t=(new Date).getTime();if(this._isDoubleClick(t)){var n=e.target;this.useItext?n&&(n.selectAll(),n.renderCursorOrSelection()):this._changeToEditingMode(e.target),this.fire(b.TEXT_EDITING)}this._lastClickTime=t}},{key:"_isDoubleClick",value:function(e){return e-this._lastClickTime<E}},{key:"_changeToEditingMode",value:function(e){var t=this.getCanvasRatio(),n=this._textarea.style;this.isPrevEditing=!0,e.remove(),this._editingObj=e,this._textarea.value=e.getText(),this._editingObjInfos={left:this._editingObj.getLeft(),top:this._editingObj.getTop(),width:this._editingObj.getWidth(),height:this._editingObj.getHeight()},n.display="block",n.left=e.oCoords.tl.x/t+"px",n.top=e.oCoords.tl.y/t+"px",n.width=Math.ceil(e.getWidth()/t)+"px",n.height=Math.ceil(e.getHeight()/t)+"px",n.transform="rotate("+e.getAngle()+"deg)",n.color=e.getFill(),n["font-size"]=e.getFontSize()/t+"px",n["font-family"]=e.getFontFamily(),n["font-style"]=e.getFontStyle(),n["font-weight"]=e.getFontWeight(),n["text-align"]=e.getTextAlign(),n["line-height"]=e.getLineHeight()+C,n["transform-origin"]="left top",this._textarea.focus()}}]),t}(g.default);e.exports=j},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(12),c=i(u),l=n(1),f=i(l),h=f.default.drawingModes,d=f.default.componentNames,p=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,h.CROPPER))}return a(t,e),s(t,[{key:"start",value:function(e){var t=e.getComponent(d.CROPPER);t.start()}},{key:"end",value:function(e){var t=e.getComponent(d.CROPPER);t.end()}}]),t}(c.default);e.exports=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(12),c=i(u),l=n(1),f=i(l),h=f.default.drawingModes,d=f.default.componentNames,p=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,h.FREE_DRAWING))}return a(t,e),s(t,[{key:"start",value:function(e,t){var n=e.getComponent(d.FREE_DRAWING);n.start(t)}},{key:"end",value:function(e){var t=e.getComponent(d.FREE_DRAWING);t.end()}}]),t}(c.default);e.exports=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(12),c=i(u),l=n(1),f=i(l),h=f.default.drawingModes,d=f.default.componentNames,p=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,h.LINE_DRAWING))}return a(t,e),s(t,[{key:"start",value:function(e,t){var n=e.getComponent(d.LINE);n.start(t)}},{key:"end",value:function(e){var t=e.getComponent(d.LINE);t.end()}}]),t}(c.default);e.exports=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(12),c=i(u),l=n(1),f=i(l),h=f.default.drawingModes,d=f.default.componentNames,p=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,h.SHAPE))}return a(t,e),s(t,[{key:"start",value:function(e){var t=e.getComponent(d.SHAPE);t.start()}},{key:"end",value:function(e){var t=e.getComponent(d.SHAPE);t.end()}}]),t}(c.default);e.exports=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(12),c=i(u),l=n(1),f=i(l),h=f.default.drawingModes,d=f.default.componentNames,p=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,h.TEXT))}return a(t,e),s(t,[{key:"start",value:function(e){var t=e.getComponent(d.TEXT);t.start()}},{key:"end",value:function(e){var t=e.getComponent(d.TEXT);t.end()}}]),t}(c.default);e.exports=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(5),r=i(o),a=r.default.util.createClass(r.default.Image.filters.Convolute,{type:"Blur",initialize:function(){var e=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9];this.matrix=e}});e.exports=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(5),r=i(o),a=r.default.util.createClass(r.default.Image.filters.BaseFilter,{type:"ColorFilter",initialize:function(e){e||(e={}),this.color=e.color||"#FFFFFF",this.threshold=e.threshold||45,this.x=e.x||null,this.y=e.y||null},applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),i=n.data,o=this.threshold,a=r.default.Color.sourceFromHex(this.color),s=void 0,u=void 0;for(this.x&&this.y&&(a=this._getColor(n,this.x,this.y)),s=0,u=i.length;s<u;s+=4)this._isOutsideThreshold(i[s],a[0],o)||this._isOutsideThreshold(i[s+1],a[1],o)||this._isOutsideThreshold(i[s+2],a[2],o)||(i[s]=i[s+1]=i[s+2]=i[s+3]=0);t.putImageData(n,0,0)},_isOutsideThreshold:function(e,t,n){var i=e-t;return Math.abs(i)>n},_getColor:function(e,t,n){var i=[0,0,0,0],o=e.data,r=e.width,a=4,s=(r*n+t)*a;return i[0]=o[s],i[1]=o[s+1],i[2]=o[s+2],i[3]=o[s+3],i}});e.exports=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(4),r=i(o),a=n(5),s=i(a),u=n(9),c="tl",l="tr",f="mt",h="ml",d="mr",p="mb",g="bl",v="br",m=s.default.util.createClass(s.default.Rect,{initialize:function(e,t){e=r.default.extend(e,t),e.type="cropzone",this.callSuper("initialize",e),this.options=e,this.on({moving:this._onMoving,scaling:this._onScaling})},_render:function(e){var t=7,n=7;this.callSuper("_render",e);var i=this.flipX?-1:1,o=this.flipY?-1:1,r=i/this.scaleX,a=o/this.scaleY;e.scale(r,a),this._fillOuterRect(e,"rgba(0, 0, 0, 0.55)"),this.options.lineWidth?this._strokeBorder(e,"rgb(255, 255, 255)",{lineWidth:this.options.lineWidth}):(this._strokeBorder(e,"rgb(0, 0, 0)",{lineDashWidth:t}),this._strokeBorder(e,"rgb(255, 255, 255)",{lineDashWidth:t,lineDashOffset:n})),e.scale(1/r,1/a)},_fillOuterRect:function(e,t){var n=this._getCoordinates(e),i=n.x,o=n.y;e.save(),e.fillStyle=t,e.beginPath(),e.moveTo(i[0]-1,o[0]-1),e.lineTo(i[3]+1,o[0]-1),e.lineTo(i[3]+1,o[3]+1),e.lineTo(i[0]-1,o[3]+1),e.lineTo(i[0]-1,o[0]-1),e.closePath(),e.moveTo(i[1],o[1]),e.lineTo(i[1],o[2]),e.lineTo(i[2],o[2]),e.lineTo(i[2],o[1]),e.lineTo(i[1],o[1]),e.closePath(),e.fill(),e.restore()},_fillInnerRect:function(e){var t=this._getCoordinates(e),n=t.x,i=t.y,o=this._caculateInnerPosition(n,(n[2]-n[1])/3),r=this._caculateInnerPosition(i,(i[2]-i[1])/3);e.save(),e.strokeStyle="rgba(255, 255, 255, 0.7)",e.lineWidth=this.options.lineWidth,e.beginPath(),e.moveTo(o[0],r[1]),e.lineTo(o[3],r[1]),e.moveTo(o[0],r[2]),e.lineTo(o[3],r[2]),e.moveTo(o[1],r[0]),e.lineTo(o[1],r[3]),e.moveTo(o[2],r[0]),e.lineTo(o[2],r[3]),e.stroke(),e.closePath(),e.restore()},_caculateInnerPosition:function(e,t){var n=[];return n[0]=e[1],n[1]=e[1]+t,n[2]=e[1]+2*t,n[3]=e[2],n},_getCoordinates:function(e){var t=this.getWidth(),n=this.getHeight(),i=t/2,o=n/2,a=this.getLeft(),s=this.getTop(),u=e.canvas,c=this.canvas.getZoom(),l=u.width/c,f=u.height/c;return{x:r.default.map([-(i+a),-i,i,i+(l-a-t)],Math.ceil),y:r.default.map([-(o+s),-o,o,o+(f-s-n)],Math.ceil)}},_strokeBorder:function(e,t,n){var i=n.lineDashWidth,o=n.lineDashOffset,r=n.lineWidth,a=this.getWidth()/2,s=this.getHeight()/2;e.save(),e.strokeStyle=t,e.setLineDash&&e.setLineDash([i,i]),o&&(e.lineDashOffset=o),r&&(e.lineWidth=r),e.beginPath(),e.moveTo(-a,-s),e.lineTo(a,-s),e.lineTo(a,s),e.lineTo(-a,s),e.lineTo(-a,-s),e.stroke(),e.restore()},_onMoving:function(){var e=this.canvas.getZoom(),t=this.getLeft(),n=this.getTop(),i=this.getWidth(),o=this.getHeight(),r=this.canvas.getWidth()/e-i,a=this.canvas.getHeight()/e-o;this.setLeft((0,u.clamp)(t,0,r)),this.setTop((0,u.clamp)(n,0,a))},_onScaling:function(e){var t=this.canvas.getPointer(e.e),n=this._calcScalingSizeFromPointer(t);this.scale(1).set(n)},_calcScalingSizeFromPointer:function(e){var t=e.x,n=e.y,i=this._calcTopLeftScalingSizeFromPointer(t,n),o=this._calcBottomRightScalingSizeFromPointer(t,n);return this._makeScalingSettings(i,o)},_calcTopLeftScalingSizeFromPointer:function(e,t){var n=this.getHeight()+this.top,i=this.getWidth()+this.left,o=(0,u.clamp)(t,0,n-1),r=(0,u.clamp)(e,0,i-1);return{top:o,left:r,width:i-r,height:n-o}},_calcBottomRightScalingSizeFromPointer:function(e,t){var n=this.canvas.getZoom(),i=this.canvas.width/n,o=this.canvas.height/n,r=this.left,a=this.top;return{width:(0,u.clamp)(e,r+1,i)-r,height:(0,u.clamp)(t,a+1,o)-a}},_makeScalingSettings:function(e,t){var n=e.width,i=e.height,o=t.height,r=t.width,a=e.left,s=e.top,u=void 0;switch(this.__corner){case c:u=e;break;case l:u={width:r,height:i,top:s};break;case g:u={width:n,height:o,left:a};break;case v:u=t;break;case h:u={width:n,left:a};break;case f:u={height:i,top:s};break;case d:u={width:r};break;case p:u={height:o}}return u},isValid:function(){return this.left>=0&&this.top>=0&&this.width>0&&this.height>0}});e.exports=m},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(5),r=i(o),a=r.default.util.createClass(r.default.Image.filters.Convolute,{type:"Emboss",initialize:function(){var e=[1,1,1,1,.7,-1,-1,-1,-1];this.matrix=e}});e.exports=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(5),r=i(o),a=r.default.util.createClass(r.default.Image.filters.Mask,{applyTo:function(e){if(this.mask){var t=e.width,n=e.height,i=this._createCanvasOfMask(t,n),o=e.getContext("2d"),r=i.getContext("2d"),a=o.getImageData(0,0,t,n);this._drawMask(r,e,o),this._mapData(r,a,t,n),o.putImageData(a,0,0)}},_createCanvasOfMask:function(e,t){var n=r.default.util.createCanvasElement();return n.width=e,n.height=t,n},_drawMask:function(e){var t=this.mask,n=t.getElement(),i=t.getLeft(),o=t.getTop(),r=t.getAngle();e.save(),e.translate(i,o),e.rotate(r*Math.PI/180),e.scale(t.scaleX,t.scaleY),e.drawImage(n,-n.width/2,-n.height/2),e.restore()},_mapData:function(e,t,n,i){for(var o=t.data,r=e.getImageData(0,0,n,i).data,a=this.channel,s=t.width*t.height*4,u=0;u<s;u+=4)o[u+3]=r[u+a]}});e.exports=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(5),r=i(o),a=r.default.util.createClass(r.default.Image.filters.Convolute,{type:"Sharpen",initialize:function(){var e=[0,-1,0,-1,5,-1,0,-1,0];this.matrix=e}});e.exports=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(4),s=i(a),u=n(2),c=i(u),l=n(5),f=i(l),h=n(67),d=i(h),p=n(62),g=i(p),v=n(64),m=i(v),y=n(69),_=i(y),b=n(65),O=i(b),k=n(68),x=i(k),w=n(71),C=i(w),E=n(66),j=i(E),M=n(63),S=i(M),T=n(70),A=i(T),I=n(72),P=i(I),D=n(73),R=i(D),N=n(74),L=i(N),F=n(75),B=i(F),U=n(76),z=i(U),H=n(1),G=i(H),X=n(9),W=i(X),Y=n(21),V=i(Y),q=G.default.componentNames,J=G.default.eventNames,Z=G.default.drawingModes,K=G.default.fObjectOptions,Q=s.default.extend,$=s.default.stamp,ee=s.default.isArray,te=s.default.isString,ne=s.default.forEachArray,ie=s.default.forEachOwnProperties,oe=1e3,re=800,ae={cssOnly:!0},se={backstoreOnly:!0},ue=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.cssMaxWidth,r=n.cssMaxHeight,a=n.useItext,s=void 0!==a&&a,u=n.useDragAddIcon,c=void 0!==u&&u;o(this,e),this.canvasImage=null,this.cssMaxWidth=i||oe,this.cssMaxHeight=r||re,this.useItext=s,this.useDragAddIcon=c,this.cropSelectionStyle={},this.imageName="",this._objects={},this._canvas=null,this._drawingMode=Z.NORMAL,this._drawingModeMap={},this._componentMap={},this._handler={onMouseDown:this._onMouseDown.bind(this),onMouseUp:this._onMouseUp.bind(this),onMouseMove:this._onMouseMove.bind(this),onObjectAdded:this._onObjectAdded.bind(this),onObjectRemoved:this._onObjectRemoved.bind(this),onObjectRotating:this._onObjectRotating.bind(this),onObjectMoved:this._onObjectMoved.bind(this),onObjectScaled:this._onObjectScaled.bind(this),onObjectSelected:this._onObjectSelected.bind(this),onPathCreated:this._onPathCreated.bind(this),onSelectionCleared:this._onSelectionCleared.bind(this),onSelectionCreated:this._onSelectionCreated.bind(this)},this._setCanvasElement(t),this._createDrawingModeInstances(),this._createComponents(),this._attachCanvasEvents(),this._fixITextOnChrome()}return r(e,[{key:"destroy",value:function(){var e=this._canvas.wrapperEl;this._canvas.clear(),e.parentNode.removeChild(e)}},{key:"deactivateAll",value:function(){return this._canvas.deactivateAll(),this}},{key:"renderAll",value:function(){return this._canvas.renderAll(),this}},{key:"add",value:function(e){var t,n=[];ee(e)?n=e:n.push(e),(t=this._canvas).add.apply(t,n)}},{key:"contains",value:function(e){return this._canvas.contains(e)}},{key:"getObjects",value:function(){return this._canvas.getObjects().slice()}},{key:"getObject",value:function(e){return this._objects[e]}},{key:"remove",value:function(e){this._canvas.remove(e)}},{key:"removeAll",value:function(e){var t=this._canvas,n=t.getObjects().slice();return t.remove.apply(t,this._canvas.getObjects()),e&&t.clear(),n}},{key:"removeObjectById",value:function(e){var t=[],n=this._canvas,i=this.getObject(e),o=i&&i.isType("group")&&!i.isEmpty();return o?(n.discardActiveGroup(),i.forEachObject(function(e){t.push(e),e.remove()})):n.contains(i)&&(t.push(i),i.remove()),t}},{key:"getObjectId",value:function(e){var t=null;for(t in this._objects)if(this._objects.hasOwnProperty(t)&&e===this._objects[t])return t;return null}},{key:"getActiveObject",value:function(){return this._canvas.getActiveObject()}},{key:"getActiveGroupObject",value:function(){return this._canvas.getActiveGroup()}},{key:"setActiveObject",value:function(e){this._canvas.setActiveObject(e)}},{key:"setCropSelectionStyle",value:function(e){this.cropSelectionStyle=e}},{key:"getComponent",value:function(e){return this._componentMap[e]}},{key:"getDrawingMode",value:function(){return this._drawingMode}},{key:"startDrawingMode",value:function(e,t){if(this._isSameDrawingMode(e))return!0;this.stopDrawingMode();var n=this._getDrawingModeInstance(e);return n&&n.start&&(n.start(this,t),this._drawingMode=e),!!n}},{key:"stopDrawingMode",value:function(){if(!this._isSameDrawingMode(Z.NORMAL)){var e=this._getDrawingModeInstance(this.getDrawingMode());e&&e.end&&e.end(this),this._drawingMode=Z.NORMAL}}},{key:"toDataURL",value:function(e){return this._canvas&&this._canvas.toDataURL(e)}},{key:"setCanvasImage",value:function(e,t){t&&$(t),this.imageName=e,this.canvasImage=t}},{key:"setCssMaxDimension",value:function(e){this.cssMaxWidth=e.width||this.cssMaxWidth,this.cssMaxHeight=e.height||this.cssMaxHeight}},{key:"adjustCanvasDimension",value:function(){var e=this.canvasImage.scale(1),t=e.getBoundingRect(),n=t.width,i=t.height,o=this._calcMaxDimension(n,i),r=this.getCanvasZoom(),a=r<=1?o:{width:o.width*r,height:o.height*r};this.setCanvasCssDimension({width:"100%",height:"100%","max-width":a.width+"px","max-height":a.height+"px"}),this.setCanvasBackstoreDimension({width:a.width,height:a.height})}},{key:"adjustCanvasDimensionForRotate",value:function(){var e=this.canvasImage.scale(1),t=e.getBoundingRect(),n=t.width,i=t.height,o={width:i,height:n};this.setCanvasCssDimension({width:"100%",height:"100%","max-width":o.width+"px","max-height":o.height+"px"}),this.setCanvasBackstoreDimension({width:n,height:i}),this._canvas.centerObject(e)}},{key:"setCanvasCssDimension",value:function(e){this._canvas.setDimensions(e,ae)}},{key:"setCanvasBackstoreDimension",value:function(e){this._canvas.setDimensions(e,se)}},{key:"setCanvasZoom",value:function(e){this._canvas.setZoom(e)}},{key:"setImageProperties",value:function(e,t){var n=this.canvasImage;n&&(n.set(e).setCoords(),t&&this._canvas.renderAll())}},{key:"getCanvasElement",value:function(){return this._canvas.getElement()}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getCanvasImage",value:function(){return this.canvasImage}},{key:"getImageName",value:function(){return this.imageName}},{key:"addImageObject",value:function(e){var t=this,n=this._callbackAfterLoadingImageObject.bind(this);return new c.default(function(i){f.default.Image.fromURL(e,function(e){n(e),i(t.createObjectProperties(e))},{crossOrigin:"Anonymous"})})}},{key:"getCenter",value:function(){return this._canvas.getCenter()}},{key:"getCropzoneRect",value:function(){return this.getComponent(q.CROPPER).getCropzoneRect()}},{key:"setCropzoneRect",value:function(e){this.getComponent(q.CROPPER).setCropzoneRect(e)}},{key:"getCroppedImageData",value:function(e){return this.getComponent(q.CROPPER).getCroppedImageData(e)}},{key:"setBrush",value:function(e){var t=this._drawingMode,n=q.FREE_DRAWING;t===Z.LINE&&(n=Z.LINE),this.getComponent(n).setBrush(e)}},{key:"setDrawingShape",value:function(e,t){this.getComponent(q.SHAPE).setStates(e,t)}},{key:"registerPaths",value:function(e){this.getComponent(q.ICON).registerPaths(e)}},{key:"changeCursor",value:function(e){var t=this.getCanvas();t.defaultCursor=e,t.renderAll()}},{key:"hasFilter",value:function(e){return this.getComponent(q.FILTER).hasFilter(e)}},{key:"setSelectionStyle",value:function(e){Q(K.SELECTION_STYLE,e)}},{key:"setObjectProperties",value:function(e,t){var n=this.getObject(e),i=Q({},t);return n.set(i),n.setCoords(),this.getCanvas().renderAll(),i}},{key:"getObjectProperties",value:function(e,t){var n=this.getObject(e),i={};return te(t)?i[t]=n[t]:ee(t)?ne(t,function(e){i[e]=n[e]}):ie(t,function(e,t){i[t]=n[t]}),i}},{key:"getObjectPosition",value:function(e,t,n){var i=this.getObject(e);return i?i.getPointByOrigin(t,n):null}},{key:"setObjectPosition",value:function(e,t){var n=this.getObject(e),i=t.x,o=t.y,r=t.originX,a=t.originY;if(!n)return!1;var s=n.getPointByOrigin(r,a),u=n.getPointByOrigin("center","center"),c=u.x-s.x,l=u.y-s.y;return n.set({left:i+c,top:o+l}),n.setCoords(),!0}},{key:"getCanvasSize",value:function(){var e=this.getCanvasImage();return{width:e?e.width:0,height:e?e.height:0}}},{key:"getCanvasZoom",value:function(){return this._canvas.getZoom()}},{key:"_getDrawingModeInstance",value:function(e){return this._drawingModeMap[e]}},{key:"_setCanvasElement",value:function(e){var t=void 0,n=void 0;t=e.nodeType?e:document.querySelector(e),"CANVAS"!==t.nodeName.toUpperCase()&&(n=document.createElement("canvas"),t.appendChild(n)),this._canvas=new f.default.Canvas(n,{containerClass:"tui-image-editor-canvas-container",enableRetinaScaling:!1,targetFindTolerance:G.default.defaultPixelTargetTolerance,rotationCursor:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAD3ElEQVRIS5WWbUyVZRjH//+ewxhsraNrAQVZk7b0NI5tUrAgHGy2rIQDBL6cc8CWQxYyEIXVigQzJnYqczN5EcHsg+gH7UVdBLodjjleRKCXrQ/MHBsbK2E12ALPrnY/yCPneM7hdH97dv+v63dd133d1/0QYSwRKQQQTfJkGHIfCcMxEJFiAMp5C4DdJP8Nx05p/hdgeHgYVqt1AEA+yT/CgYQL2Amg+dnEZ1Dz3rso3rHjDsktJLuWgywLEJE1AH5VjhKfelr3l5mViUaXS8xmcy2AgyQlGCgoQETWARjyer3o7+vDiZZWXOnpMfzExcVhu9OBXaWl3wFwkpwKBAkIEJFyAEfaWlvx5bFjmLoT0BaaSUNlVZWCjAGwkRzxhzwAEJF9ABq3FhSgv68/ZIljYmPhuf6T0vwOIJfkLyEBIpIF4Mfc7GyMDPsGYzabMT09bdi/nJGBto529X0OwFsk/wlZIhExAfjtUENDYktTs6Fda7HgwMcHVXvqh6xpGir36mVRmkqSn4dK0yiRiLw5MTHRmZWxAXNzc7pN8gvJaOvomI+KiroIIPullFQcOXoU65PXq+00kp6w21REzrY0NecfamjQbSIjI9F99Spi42IdAB4F8Nk9Z1cAqDswuZxzn5ssIreLHY6EXnevbmfLy8Vhl+s6yVQRqbgHUPQPSHoXnYvIIyqeYMClJZKNmVkYG1MdB73uW7dtqyV5QEScAKZIfusftYiUAfjCb+zcIqnfSh/AhrR0jI+P6z4Ou1wqixqSjaFKISLfNx9v2lRSusuQiUhAwFS+Ldd8c2hIF6ou2VtT3UlSjeqAS0QeBvD3qxtfweWuHxYyr6vD+7W1F0jm+GfQ/VF9fWZ728LIj09IQFdPtzciImIdyZ8DEURk/+jI6Ie2zZuN7favTiEtPb2EpN7rS0tUeWNw8NOCvHxDXFa+GxV79qix/AbJ0aUQESkBcFw5Hx1Z2HosJgbua555TdMeJ/mnP2AlgL+c2+245rnf3uUVFXinrMyrmbRvAPSplw3A6wCeL7Lb4em9r91fXwe70/k1SftiMD6zSESqAHxitTyHmZkZI+AnV61Cjs2G1YmrcXf+LgYHBnDh/HkfzYspKTh1+vSsZtLWkLwdDPAQABXpa0kWC2ZnZkM1kLGXZE3CiZPtWLFyRSHJzqVGgaapKsFZAJvysnOgnslgiyQcRU7sq672RkVH7wz0UxDsPVCZqHI19rrduHzpEm7eGMLk5CRMJhOeiI9HSmoqCrcUqm5TJ/w2SXU+D6yQT6aIqBlUtHioANRYUOsWADeAMwAuhnoy/wO8rHIopxJHwwAAAABJRU5ErkJggg==) 6 6, alias"
})}},{key:"_createDrawingModeInstances",value:function(){this._register(this._drawingModeMap,new P.default),this._register(this._drawingModeMap,new R.default),this._register(this._drawingModeMap,new L.default),this._register(this._drawingModeMap,new B.default),this._register(this._drawingModeMap,new z.default)}},{key:"_createComponents",value:function(){this._register(this._componentMap,new d.default(this)),this._register(this._componentMap,new g.default(this)),this._register(this._componentMap,new m.default(this)),this._register(this._componentMap,new _.default(this)),this._register(this._componentMap,new O.default(this)),this._register(this._componentMap,new x.default(this)),this._register(this._componentMap,new C.default(this)),this._register(this._componentMap,new j.default(this)),this._register(this._componentMap,new S.default(this)),this._register(this._componentMap,new A.default(this))}},{key:"_register",value:function(e,t){e[t.getName()]=t}},{key:"_isSameDrawingMode",value:function(e){return this.getDrawingMode()===e}},{key:"_calcMaxDimension",value:function(e,t){var n=this.cssMaxWidth/e,i=this.cssMaxHeight/t,o=Math.min(e,this.cssMaxWidth),r=Math.min(t,this.cssMaxHeight);return n<1&&n<i?(o=e*n,r=t*n):i<1&&i<n&&(o=e*i,r=t*i),{width:Math.floor(o),height:Math.floor(r)}}},{key:"_callbackAfterLoadingImageObject",value:function(e){var t=this.getCanvasImage().getCenterPoint();e.set(G.default.fObjectOptions.SELECTION_STYLE),e.set({left:t.x,top:t.y,crossOrigin:"Anonymous"}),this.getCanvas().add(e).setActiveObject(e)}},{key:"_attachCanvasEvents",value:function(){var e=this._canvas,t=this._handler;e.on({"mouse:down":t.onMouseDown,"mouse:up":t.onMouseUp,"mouse:move":t.onMouseMove,"object:added":t.onObjectAdded,"object:removed":t.onObjectRemoved,"object:rotating":t.onObjectRotating,"object:moving":t.onObjectMoved,"object:scaling":t.onObjectScaled,"object:selected":t.onObjectSelected,"path:created":t.onPathCreated,"selection:cleared":t.onSelectionCleared,"selection:created":t.onSelectionCreated})}},{key:"_fixITextOnChrome",value:function(){f.default.IText.prototype.initHiddenTextarea=function(){this.hiddenTextarea=f.default.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off");var e=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+e.top+"; left: "+e.left+"; opacity: 0; width: 0px; height: 0px; z-index: -999; white-space: nowrap;",f.default.document.body.appendChild(this.hiddenTextarea),f.default.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),f.default.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),f.default.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),f.default.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),f.default.util.addListener(this.hiddenTextarea,"cut",this.cut.bind(this)),f.default.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),f.default.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),f.default.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),f.default.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(f.default.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)}}},{key:"_onMouseDown",value:function(e){var t=this._canvas.getPointer(e.e);this.fire(J.MOUSE_DOWN,e.e,t)}},{key:"_onMouseUp",value:function(e){var t=this._canvas.getPointer(e.e);this.fire(J.MOUSE_UP,e.e,t)}},{key:"_onMouseMove",value:function(e){var t=this._canvas.getPointer(e.e);this.fire(J.MOUSE_MOVE,e.e,t)}},{key:"_onObjectAdded",value:function(e){var t=e.target;t.isType("cropzone")||this._addFabricObject(t)}},{key:"_onObjectRemoved",value:function(e){var t=e.target,n=this.createObjectProperties(t);this._removeFabricObject($(t)),this.fire(J.OBJECT_REMOVED,n)}},{key:"_onObjectRotating",value:function(e){var t=e.target,n=this.createObjectProperties(t);this.fire(J.OBJECT_ROTATING,n)}},{key:"_onObjectMoved",value:function(e){var t=e.target,n=this.createObjectProperties(t);this.fire(J.OBJECT_MOVED,n)}},{key:"_onObjectScaled",value:function(e){var t=e.target,n=this.createObjectProperties(t);this.fire(J.OBJECT_SCALED,n)}},{key:"_onObjectSelected",value:function(e){var t=e.target,n=this.createObjectProperties(t);this._canvas.bringToFront(t),this.fire(J.OBJECT_ACTIVATED,n)}},{key:"_onPathCreated",value:function(e){e.path.set(G.default.fObjectOptions.SELECTION_STYLE);var t=this.createObjectProperties(e.path);this.fire(J.ADD_OBJECT,t)}},{key:"_onSelectionCleared",value:function(){this.fire(J.SELECTION_CLEARED)}},{key:"_onSelectionCreated",value:function(e){this.fire(J.SELECTION_CREATED,e.target)}},{key:"discardSelection",value:function(){this._canvas.discardActiveGroup(),this._canvas.discardActiveObject(),this._canvas.renderAll()}},{key:"changeSelectableAll",value:function(e){this._canvas.forEachObject(function(t){t.selectable=e,t.evented=e,t.hoverCursor=e?"move":"crosshair"})}},{key:"createObjectProperties",value:function(e){var t=["left","top","width","height","fill","stroke","strokeWidth","opacity","angle"],n={id:$(e),type:e.type};return Q(n,W.default.getProperties(e,t)),["i-text","text"].indexOf(e.type)>-1&&Q(n,this._createTextProperties(e,n)),n}},{key:"_createTextProperties",value:function(e){var t=["text","fontFamily","fontSize","fontStyle","fontWeight","textAlign","textDecoration"],n={};return Q(n,W.default.getProperties(e,t)),n}},{key:"_addFabricObject",value:function(e){var t=$(e);return this._objects[t]=e,t}},{key:"_removeFabricObject",value:function(e){delete this._objects[e]}}]),e}();V.default.mixin(ue),e.exports=ue},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){n(this,e),this.versionnumber="1.2.4",this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}]}return i(e,null,[{key:"tracerDefaultOption",value:function(){return{pathomit:100,ltres:.1,qtres:1,scale:1,strokewidth:5,viewbox:!1,linefilter:!0,desc:!1,rightangleenhance:!1,pal:[{r:0,g:0,b:0,a:255},{r:255,g:255,b:255,a:255}]}}}]),i(e,[{key:"imageToSVG",value:function(e,t,n){var i=this;n=this.checkoptions(n),this.loadImage(e,function(e){t(i.imagedataToSVG(i.getImgdata(e),n))},n)}},{key:"imagedataToSVG",value:function(e,t){t=this.checkoptions(t);var n=this.imagedataToTracedata(e,t);return this.getsvgstring(n,t)}},{key:"imageToTracedata",value:function(e,t,n){var i=this;n=this.checkoptions(n),this.loadImage(e,function(e){t(i.imagedataToTracedata(i.getImgdata(e),n))},n)}},{key:"imagedataToTracedata",value:function(e,t){t=this.checkoptions(t);var n=this.colorquantization(e,t),i=void 0;if(0===t.layering){i={layers:[],palette:n.palette,width:n.array[0].length-2,height:n.array.length-2};for(var o=0;o<n.palette.length;o+=1){var r=this.batchtracepaths(this.internodes(this.pathscan(this.layeringstep(n,o),t.pathomit),t),t.ltres,t.qtres);i.layers.push(r)}}else{var a=this.layering(n);t.layercontainerid&&this.drawLayers(a,this.specpalette,t.scale,t.layercontainerid);var s=this.batchpathscan(a,t.pathomit),u=this.batchinternodes(s,t);i={layers:this.batchtracelayers(u,t.ltres,t.qtres),palette:n.palette,width:e.width,height:e.height}}return i}},{key:"checkoptions",value:function(e){e=e||{},"string"==typeof e&&(e=e.toLowerCase(),e=this.optionpresets[e]?this.optionpresets[e]:{});for(var t=Object.keys(this.optionpresets.default),n=0;n<t.length;n+=1)e.hasOwnProperty(t[n])||(e[t[n]]=this.optionpresets.default[t[n]]);return e}},{key:"colorquantization",value:function(e,t){var n=[],i=0,o=void 0,r=void 0,a=void 0,s=[],u=e.width*e.height,c=void 0,l=void 0,f=void 0,h=void 0,d=void 0;for(l=0;l<e.height+2;l+=1)for(n[l]=[],c=0;c<e.width+2;c+=1)n[l][c]=-1;for(d=t.pal?t.pal:0===t.colorsampling?this.generatepalette(t.numberofcolors):1===t.colorsampling?this.samplepalette(t.numberofcolors,e):this.samplepalette2(t.numberofcolors,e),t.blurradius>0&&(e=this.blur(e,t.blurradius,t.blurdelta)),h=0;h<t.colorquantcycles;h+=1){if(h>0)for(f=0;f<d.length;f+=1)s[f].n>0&&(d[f]={r:Math.floor(s[f].r/s[f].n),g:Math.floor(s[f].g/s[f].n),b:Math.floor(s[f].b/s[f].n),a:Math.floor(s[f].a/s[f].n)}),s[f].n/u<t.mincolorratio&&h<t.colorquantcycles-1&&(d[f]={r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())});for(c=0;c<d.length;c+=1)s[c]={r:0,g:0,b:0,a:0,n:0};for(l=0;l<e.height;l+=1)for(c=0;c<e.width;c+=1){for(i=4*(l*e.width+c),a=0,r=1024,f=0;f<d.length;f+=1)o=Math.abs(d[f].r-e.data[i])+Math.abs(d[f].g-e.data[i+1])+Math.abs(d[f].b-e.data[i+2])+Math.abs(d[f].a-e.data[i+3]),o<r&&(r=o,a=f);s[a].r+=e.data[i],s[a].g+=e.data[i+1],s[a].b+=e.data[i+2],s[a].a+=e.data[i+3],s[a].n+=1,n[l+1][c+1]=a}}return{array:n,palette:d}}},{key:"samplepalette",value:function(e,t){for(var n=void 0,i=[],o=0;o<e;o+=1)n=4*Math.floor(Math.random()*t.data.length/4),i.push({r:t.data[n],g:t.data[n+1],b:t.data[n+2],a:t.data[n+3]});return i}},{key:"samplepalette2",value:function(e,t){for(var n=void 0,i=[],o=Math.ceil(Math.sqrt(e)),r=Math.ceil(e/o),a=t.width/(o+1),s=t.height/(r+1),u=0;u<r;u+=1)for(var c=0;c<o&&i.length!==e;c+=1)n=4*Math.floor((u+1)*s*t.width+(c+1)*a),i.push({r:t.data[n],g:t.data[n+1],b:t.data[n+2],a:t.data[n+3]});return i}},{key:"generatepalette",value:function(e){var t=[],n=void 0,i=void 0,o=void 0;if(e<8)for(var r=Math.floor(255/(e-1)),a=0;a<e;a+=1)t.push({r:a*r,g:a*r,b:a*r,a:255});else{var s=Math.floor(Math.pow(e,1/3)),u=Math.floor(255/(s-1)),c=e-s*s*s;for(n=0;n<s;n+=1)for(i=0;i<s;i+=1)for(o=0;o<s;o+=1)t.push({r:n*u,g:i*u,b:o*u,a:255});for(n=0;n<c;n+=1)t.push({r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())})}return t}},{key:"layering",value:function(e){var t=[],n=0,i=e.array.length,o=e.array[0].length,r=void 0,a=void 0,s=void 0,u=void 0,c=void 0,l=void 0,f=void 0,h=void 0,d=void 0,p=void 0,g=void 0;for(g=0;g<e.palette.length;g+=1)for(t[g]=[],p=0;p<i;p+=1)for(t[g][p]=[],d=0;d<o;d+=1)t[g][p][d]=0;for(p=1;p<i-1;p+=1)for(d=1;d<o-1;d+=1)n=e.array[p][d],r=e.array[p-1][d-1]===n?1:0,a=e.array[p-1][d]===n?1:0,s=e.array[p-1][d+1]===n?1:0,u=e.array[p][d-1]===n?1:0,c=e.array[p][d+1]===n?1:0,l=e.array[p+1][d-1]===n?1:0,f=e.array[p+1][d]===n?1:0,h=e.array[p+1][d+1]===n?1:0,t[n][p+1][d+1]=1+2*c+4*h+8*f,u||(t[n][p+1][d]=2+4*f+8*l),a||(t[n][p][d+1]=0+2*s+4*c+8),r||(t[n][p][d]=0+2*a+4+8*u);return t}},{key:"layeringstep",value:function(e,t){var n=[],i=e.array.length,o=e.array[0].length,r=void 0,a=void 0;for(a=0;a<i;a+=1)for(n[a]=[],r=0;r<o;r+=1)n[a][r]=0;for(a=1;a<i;a+=1)for(r=1;r<o;r+=1)n[a][r]=(e.array[a-1][r-1]===t?1:0)+(e.array[a-1][r]===t?2:0)+(e.array[a][r-1]===t?8:0)+(e.array[a][r]===t?4:0);return n}},{key:"pathscan",value:function(e,t){for(var n=[],i=0,o=0,r=0,a=0,s=e[0].length,u=e.length,c=0,l=!0,f=!1,h=void 0,d=0;d<u;d+=1)for(var p=0;p<s;p+=1)if(4===e[d][p]||11===e[d][p])for(r=p,a=d,n[i]={},n[i].points=[],n[i].boundingbox=[r,a,r,a],n[i].holechildren=[],l=!1,o=0,f=11===e[d][p],c=1;!l;){if(n[i].points[o]={},n[i].points[o].x=r-1,n[i].points[o].y=a-1,n[i].points[o].t=e[a][r],r-1<n[i].boundingbox[0]&&(n[i].boundingbox[0]=r-1),r-1>n[i].boundingbox[2]&&(n[i].boundingbox[2]=r-1),a-1<n[i].boundingbox[1]&&(n[i].boundingbox[1]=a-1),a-1>n[i].boundingbox[3]&&(n[i].boundingbox[3]=a-1),h=this.pathscan_combined_lookup[e[a][r]][c],e[a][r]=h[0],c=h[1],r+=h[2],a+=h[3],r-1===n[i].points[0].x&&a-1===n[i].points[0].y)if(l=!0,n[i].points.length<t)n.pop();else{if(n[i].isholepath=!!f,f){for(var g=0,v=[-1,-1,s+1,u+1],m=0;m<i;m++)!n[m].isholepath&&this.boundingboxincludes(n[m].boundingbox,n[i].boundingbox)&&this.boundingboxincludes(v,n[m].boundingbox)&&(g=m,v=n[m].boundingbox);n[g].holechildren.push(i)}i+=1}o+=1}return n}},{key:"boundingboxincludes",value:function(e,t){return e[0]<t[0]&&e[1]<t[1]&&e[2]>t[2]&&e[3]>t[3]}},{key:"batchpathscan",value:function(e,t){var n=[];for(var i in e)e.hasOwnProperty(i)&&(n[i]=this.pathscan(e[i],t));return n}},{key:"internodes",value:function(e,t){var n=[],i=0,o=0,r=0,a=0,s=0,u=void 0,c=void 0;for(u=0;u<e.length;u+=1)for(n[u]={},n[u].points=[],n[u].boundingbox=e[u].boundingbox,n[u].holechildren=e[u].holechildren,n[u].isholepath=e[u].isholepath,i=e[u].points.length,c=0;c<i;c+=1)o=(c+1)%i,r=(c+2)%i,a=(c-1+i)%i,s=(c-2+i)%i,t.rightangleenhance&&this.testrightangle(e[u],s,a,c,o,r)&&(n[u].points.length>0&&(n[u].points[n[u].points.length-1].linesegment=this.getdirection(n[u].points[n[u].points.length-1].x,n[u].points[n[u].points.length-1].y,e[u].points[c].x,e[u].points[c].y)),n[u].points.push({x:e[u].points[c].x,y:e[u].points[c].y,linesegment:this.getdirection(e[u].points[c].x,e[u].points[c].y,(e[u].points[c].x+e[u].points[o].x)/2,(e[u].points[c].y+e[u].points[o].y)/2)})),n[u].points.push({x:(e[u].points[c].x+e[u].points[o].x)/2,y:(e[u].points[c].y+e[u].points[o].y)/2,linesegment:this.getdirection((e[u].points[c].x+e[u].points[o].x)/2,(e[u].points[c].y+e[u].points[o].y)/2,(e[u].points[o].x+e[u].points[r].x)/2,(e[u].points[o].y+e[u].points[r].y)/2)});return n}},{key:"testrightangle",value:function(e,t,n,i,o,r){return e.points[i].x===e.points[t].x&&e.points[i].x===e.points[n].x&&e.points[i].y===e.points[o].y&&e.points[i].y===e.points[r].y||e.points[i].y===e.points[t].y&&e.points[i].y===e.points[n].y&&e.points[i].x===e.points[o].x&&e.points[i].x===e.points[r].x}},{key:"getdirection",value:function(e,t,n,i){var o=8;return o=e<n?t<i?1:t>i?7:0:e>n?t<i?3:t>i?5:4:t<i?2:t>i?6:8}},{key:"batchinternodes",value:function(e,t){var n=[];for(var i in e)e.hasOwnProperty(i)&&(n[i]=this.internodes(e[i],t));return n}},{key:"tracepath",value:function(e,t,n){var i=0,o=void 0,r=void 0,a=void 0,s={};for(s.segments=[],s.boundingbox=e.boundingbox,s.holechildren=e.holechildren,s.isholepath=e.isholepath;i<e.points.length;){for(o=e.points[i].linesegment,r=-1,a=i+1;(e.points[a].linesegment===o||e.points[a].linesegment===r||r===-1)&&a<e.points.length-1;)e.points[a].linesegment!==o&&r===-1&&(r=e.points[a].linesegment),a+=1;a===e.points.length-1&&(a=0),s.segments=s.segments.concat(this.fitseq(e,t,n,i,a)),i=a>0?a:e.points.length}return s}},{key:"fitseq",value:function(e,t,n,i,o){if(o>e.points.length||o<0)return[];var r=i,a=0,s=!0,u=void 0,c=void 0,l=void 0,f=o-i;f<0&&(f+=e.points.length);for(var h=(e.points[o].x-e.points[i].x)/f,d=(e.points[o].y-e.points[i].y)/f,p=(i+1)%e.points.length,g=void 0;p!=o;)g=p-i,g<0&&(g+=e.points.length),u=e.points[i].x+h*g,c=e.points[i].y+d*g,l=(e.points[p].x-u)*(e.points[p].x-u)+(e.points[p].y-c)*(e.points[p].y-c),l>t&&(s=!1),l>a&&(r=p,a=l),p=(p+1)%e.points.length;if(s)return[{type:"L",x1:e.points[i].x,y1:e.points[i].y,x2:e.points[o].x,y2:e.points[o].y}];var v=r;s=!0,a=0;var m=(v-i)/f,y=(1-m)*(1-m),_=2*(1-m)*m,b=m*m,O=(y*e.points[i].x+b*e.points[o].x-e.points[v].x)/-_,k=(y*e.points[i].y+b*e.points[o].y-e.points[v].y)/-_;for(p=i+1;p!=o;)m=(p-i)/f,y=(1-m)*(1-m),_=2*(1-m)*m,b=m*m,u=y*e.points[i].x+_*O+b*e.points[o].x,c=y*e.points[i].y+_*k+b*e.points[o].y,l=(e.points[p].x-u)*(e.points[p].x-u)+(e.points[p].y-c)*(e.points[p].y-c),l>n&&(s=!1),l>a&&(r=p,a=l),p=(p+1)%e.points.length;if(s)return[{type:"Q",x1:e.points[i].x,y1:e.points[i].y,x2:O,y2:k,x3:e.points[o].x,y3:e.points[o].y}];var x=v;return this.fitseq(e,t,n,i,x).concat(this.fitseq(e,t,n,x,o))}},{key:"batchtracepaths",value:function(e,t,n){var i=[];for(var o in e)e.hasOwnProperty(o)&&i.push(this.tracepath(e[o],t,n));return i}},{key:"batchtracelayers",value:function(e,t,n){var i=[];for(var o in e)e.hasOwnProperty(o)&&(i[o]=this.batchtracepaths(e[o],t,n));return i}},{key:"roundtodec",value:function(e,t){return Number(e.toFixed(t))}},{key:"svgpathstring",value:function(e,t,n,i){var o=e.layers[t],r=o[n],a="",s=void 0;if(i.linefilter&&r.segments.length<3)return a;if(a="<path "+(i.desc?'desc="l '+t+" p "+n+'" ':"")+this.tosvgcolorstr(e.palette[t],i)+'d="',i.roundcoords===-1){for(a+="M "+r.segments[0].x1*i.scale+" "+r.segments[0].y1*i.scale+" ",s=0;s<r.segments.length;s++)a+=r.segments[s].type+" "+r.segments[s].x2*i.scale+" "+r.segments[s].y2*i.scale+" ",r.segments[s].hasOwnProperty("x3")&&(a+=r.segments[s].x3*i.scale+" "+r.segments[s].y3*i.scale+" ");a+="Z "}else{for(a+="M "+this.roundtodec(r.segments[0].x1*i.scale,i.roundcoords)+" "+this.roundtodec(r.segments[0].y1*i.scale,i.roundcoords)+" ",s=0;s<r.segments.length;s++)a+=r.segments[s].type+" "+this.roundtodec(r.segments[s].x2*i.scale,i.roundcoords)+" "+this.roundtodec(r.segments[s].y2*i.scale,i.roundcoords)+" ",r.segments[s].hasOwnProperty("x3")&&(a+=this.roundtodec(r.segments[s].x3*i.scale,i.roundcoords)+" "+this.roundtodec(r.segments[s].y3*i.scale,i.roundcoords)+" ");a+="Z "}for(var u=0;u<r.holechildren.length;u++){var c=o[r.holechildren[u]];if(i.roundcoords===-1)for(a+=c.segments[c.segments.length-1].hasOwnProperty("x3")?"M "+c.segments[c.segments.length-1].x3*i.scale+" "+c.segments[c.segments.length-1].y3*i.scale+" ":"M "+c.segments[c.segments.length-1].x2*i.scale+" "+c.segments[c.segments.length-1].y2*i.scale+" ",s=c.segments.length-1;s>=0;s--)a+=c.segments[s].type+" ",c.segments[s].hasOwnProperty("x3")&&(a+=c.segments[s].x2*i.scale+" "+c.segments[s].y2*i.scale+" "),a+=c.segments[s].x1*i.scale+" "+c.segments[s].y1*i.scale+" ";else for(a+=c.segments[c.segments.length-1].hasOwnProperty("x3")?"M "+this.roundtodec(c.segments[c.segments.length-1].x3*i.scale)+" "+this.roundtodec(c.segments[c.segments.length-1].y3*i.scale)+" ":"M "+this.roundtodec(c.segments[c.segments.length-1].x2*i.scale)+" "+this.roundtodec(c.segments[c.segments.length-1].y2*i.scale)+" ",s=c.segments.length-1;s>=0;s--)a+=c.segments[s].type+" ",c.segments[s].hasOwnProperty("x3")&&(a+=this.roundtodec(c.segments[s].x2*i.scale)+" "+this.roundtodec(c.segments[s].y2*i.scale)+" "),a+=this.roundtodec(c.segments[s].x1*i.scale)+" "+this.roundtodec(c.segments[s].y1*i.scale)+" ";a+="Z "}if(a+='" />',i.lcpr||i.qcpr){for(s=0;s<r.segments.length;s++)r.segments[s].hasOwnProperty("x3")&&i.qcpr&&(a+='<circle cx="'+r.segments[s].x2*i.scale+'" cy="'+r.segments[s].y2*i.scale+'" r="'+i.qcpr+'" fill="cyan" stroke-width="'+.2*i.qcpr+'" stroke="black" />',a+='<circle cx="'+r.segments[s].x3*i.scale+'" cy="'+r.segments[s].y3*i.scale+'" r="'+i.qcpr+'" fill="white" stroke-width="'+.2*i.qcpr+'" stroke="black" />',a+='<line x1="'+r.segments[s].x1*i.scale+'" y1="'+r.segments[s].y1*i.scale+'" x2="'+r.segments[s].x2*i.scale+'" y2="'+r.segments[s].y2*i.scale+'" stroke-width="'+.2*i.qcpr+'" stroke="cyan" />',a+='<line x1="'+r.segments[s].x2*i.scale+'" y1="'+r.segments[s].y2*i.scale+'" x2="'+r.segments[s].x3*i.scale+'" y2="'+r.segments[s].y3*i.scale+'" stroke-width="'+.2*i.qcpr+'" stroke="cyan" />'),!r.segments[s].hasOwnProperty("x3")&&i.lcpr&&(a+='<circle cx="'+r.segments[s].x2*i.scale+'" cy="'+r.segments[s].y2*i.scale+'" r="'+i.lcpr+'" fill="white" stroke-width="'+.2*i.lcpr+'" stroke="black" />');for(var u=0;u<r.holechildren.length;u++){var c=o[r.holechildren[u]];for(s=0;s<c.segments.length;s++)c.segments[s].hasOwnProperty("x3")&&i.qcpr&&(a+='<circle cx="'+c.segments[s].x2*i.scale+'" cy="'+c.segments[s].y2*i.scale+'" r="'+i.qcpr+'" fill="cyan" stroke-width="'+.2*i.qcpr+'" stroke="black" />',a+='<circle cx="'+c.segments[s].x3*i.scale+'" cy="'+c.segments[s].y3*i.scale+'" r="'+i.qcpr+'" fill="white" stroke-width="'+.2*i.qcpr+'" stroke="black" />',a+='<line x1="'+c.segments[s].x1*i.scale+'" y1="'+c.segments[s].y1*i.scale+'" x2="'+c.segments[s].x2*i.scale+'" y2="'+c.segments[s].y2*i.scale+'" stroke-width="'+.2*i.qcpr+'" stroke="cyan" />',a+='<line x1="'+c.segments[s].x2*i.scale+'" y1="'+c.segments[s].y2*i.scale+'" x2="'+c.segments[s].x3*i.scale+'" y2="'+c.segments[s].y3*i.scale+'" stroke-width="'+.2*i.qcpr+'" stroke="cyan" />'),!c.segments[s].hasOwnProperty("x3")&&i.lcpr&&(a+='<circle cx="'+c.segments[s].x2*i.scale+'" cy="'+c.segments[s].y2*i.scale+'" r="'+i.lcpr+'" fill="white" stroke-width="'+.2*i.lcpr+'" stroke="black" />')}}return a}},{key:"getsvgstring",value:function(e,t){t=this.checkoptions(t);for(var n=e.width*t.scale,i=e.height*t.scale,o="<svg "+(t.viewbox?'viewBox="0 0 '+n+" "+i+'" ':'width="'+n+'" height="'+i+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+this.versionnumber+'" >',r=0;r<e.layers.length;r+=1)for(var a=0;a<e.layers[r].length;a+=1)e.layers[r][a].isholepath||(o+=this.svgpathstring(e,r,a,t));return o+="</svg>"}},{key:"compareNumbers",value:function(e,t){return e-t}},{key:"torgbastr",value:function(e){return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"}},{key:"tosvgcolorstr",value:function(e,t){return'fill="rgb('+e.r+","+e.g+","+e.b+')" stroke="rgb('+e.r+","+e.g+","+e.b+')" stroke-width="'+t.strokewidth+'" opacity="'+e.a/255+'" '}},{key:"appendSVGString",value:function(e,t){var n=void 0;t?(n=document.getElementById(t),n||(n=document.createElement("div"),n.id=t,document.body.appendChild(n))):(n=document.createElement("div"),document.body.appendChild(n)),n.innerHTML+=e}},{key:"blur",value:function(e,t,n){var i=void 0,o=void 0,r=void 0,a=void 0,s=void 0,u=void 0,c=void 0,l=void 0,f=void 0,h=void 0,d={width:e.width,height:e.height,data:[]};if(t=Math.floor(t),t<1)return e;t>5&&(t=5),n=Math.abs(n),n>1024&&(n=1024);var p=this.gks[t-1];for(o=0;o<e.height;o++)for(i=0;i<e.width;i++){for(u=0,c=0,l=0,f=0,h=0,r=-t;r<t+1;r++)i+r>0&&i+r<e.width&&(s=4*(o*e.width+i+r),u+=e.data[s]*p[r+t],c+=e.data[s+1]*p[r+t],l+=e.data[s+2]*p[r+t],f+=e.data[s+3]*p[r+t],h+=p[r+t]);s=4*(o*e.width+i),d.data[s]=Math.floor(u/h),d.data[s+1]=Math.floor(c/h),d.data[s+2]=Math.floor(l/h),d.data[s+3]=Math.floor(f/h)}var g=new Uint8ClampedArray(d.data);for(o=0;o<e.height;o++)for(i=0;i<e.width;i++){for(u=0,c=0,l=0,f=0,h=0,r=-t;r<t+1;r++)o+r>0&&o+r<e.height&&(s=4*((o+r)*e.width+i),u+=g[s]*p[r+t],c+=g[s+1]*p[r+t],l+=g[s+2]*p[r+t],f+=g[s+3]*p[r+t],h+=p[r+t]);s=4*(o*e.width+i),d.data[s]=Math.floor(u/h),d.data[s+1]=Math.floor(c/h),d.data[s+2]=Math.floor(l/h),d.data[s+3]=Math.floor(f/h)}for(o=0;o<e.height;o++)for(i=0;i<e.width;i++)s=4*(o*e.width+i),a=Math.abs(d.data[s]-e.data[s])+Math.abs(d.data[s+1]-e.data[s+1])+Math.abs(d.data[s+2]-e.data[s+2])+Math.abs(d.data[s+3]-e.data[s+3]),a>n&&(d.data[s]=e.data[s],d.data[s+1]=e.data[s+1],d.data[s+2]=e.data[s+2],d.data[s+3]=e.data[s+3]);return d}},{key:"loadImage",value:function(e,t,n){var i=new Image;n&&n.corsenabled&&(i.crossOrigin="Anonymous"),i.src=e,i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;var n=e.getContext("2d");n.drawImage(i,0,0),t(e)}}},{key:"getImgdata",value:function(e){var t=e.getContext("2d");return t.getImageData(0,0,e.width,e.height)}},{key:"drawLayers",value:function(e,t,n,i){n=n||1;var o=void 0,r=void 0,a=void 0,s=void 0,u=void 0,c=void 0;i?(c=document.getElementById(i),c||(c=document.createElement("div"),c.id=i,document.body.appendChild(c))):(c=document.createElement("div"),document.body.appendChild(c));for(u in e)if(e.hasOwnProperty(u)){o=e[u][0].length,r=e[u].length;var l=document.createElement("canvas");l.width=o*n,l.height=r*n;var f=l.getContext("2d");for(s=0;s<r;s+=1)for(a=0;a<o;a+=1)f.fillStyle=this.torgbastr(t[e[u][s][a]%t.length]),f.fillRect(a*n,s*n,n,n);c.appendChild(l)}}}]),e}();t.default=o},function(e,t){"use strict";function n(e){var t=e.getOriginX(),n=e.getOriginY(),i=t.substring(0,1)+n.substring(0,1);e.startPoint=e.origins[i]}function i(e,t,n){var i=e.x,o=e.y,r=t.x,a=t.y,s=n*Math.PI/180,u=(r-i)*Math.cos(s)-(a-o)*Math.sin(s)+i,c=(r-i)*Math.sin(s)+(a-o)*Math.cos(s)+o;return{originX:i>u?"right":"left",originY:o>c?"bottom":"top"}}function o(e){return"center"===e.getOriginX()&&"center"===e.getOriginY()}function r(e,t){var n=t.getPointByOrigin("center","center"),o=-t.getAngle(),r=i(n,e,o),a=r.originX,s=r.originY,u=t.getPointByOrigin(a,s),c=t.getLeft()-(n.x-u.x),l=t.getTop()-(n.y-u.y);t.set({originX:a,originY:s,left:c,top:l}),t.setCoords()}function a(e,t){var n=t.startPoint,o=-t.getAngle(),r=i(n,e,o),a=r.originX,s=r.originY;t.setPositionByOrigin(n,a,s)}function s(e){var t=e.type,n=e.scaleX,i=e.scaleY,o=l[t],r=e[o.w]*n,a=e[o.h]*i;if(e.isRegular){var s=Math.max(n,i);r=e[o.w]*s,a=e[o.h]*s}var u={hasControls:!1,hasBorders:!1,scaleX:1,scaleY:1};u[o.w]=r,u[o.h]=a,e.set(u)}function u(e,t){var n=t.type,i=t.strokeWidth,o=t.startPoint,r=c[n],a=l[n],s=!("triangle"!==t.type),u={},f=Math.abs(o.x-e.x)/r,h=Math.abs(o.y-e.y)/r;f>i&&(f-=i/r),h>i&&(h-=i/r),t.isRegular&&(f=h=Math.max(f,h),s&&(h=Math.sqrt(3)/2*f)),u[a.w]=f,u[a.h]=h,t.set(u)}var c={rect:1,circle:2,triangle:1},l={rect:{w:"width",h:"height"},circle:{w:"rx",h:"ry"},triangle:{w:"width",h:"height"}};e.exports={setOrigins:function(e){var t=e.getPointByOrigin("left","top"),n=e.getPointByOrigin("right","top"),i=e.getPointByOrigin("right","bottom"),o=e.getPointByOrigin("left","bottom");e.origins={lt:t,rt:n,rb:i,lb:o}},resize:function(e,t,i){o(e)&&(r(t,e),n(e)),i?s(e,t):u(t,e),a(t,e)},adjustOriginToCenter:function(e){var t=e.getPointByOrigin("center","center"),n=e.getOriginX(),i=e.getOriginY(),o=e.getPointByOrigin(n,i),r=e.getLeft()+(t.x-o.x),a=e.getTop()+(t.y-o.y);e.set({hasControls:!0,hasBorders:!0,originX:"center",originY:"center",left:r,top:a}),e.setCoords()}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(4),s=i(a),u=n(2),c=i(u),l=n(88),f=i(l),h=n(42),d=i(h),p=n(3),g=i(p),v=n(83),m=i(v),y=n(1),_=i(y),b=n(9),O=n(21),k=i(O),x=_.default.eventNames,w=_.default.commandNames,C=_.default.keyCodes,E=_.default.rejectMessages,j=s.default.isUndefined,M=s.default.forEach,S=function(){function e(t,n){o(this,e),n=s.default.extend({includeUI:!1,usageStatistics:!1},n),this.mode=null,this.activeObjectId=null,this.allowObjectRemoval=!0,this._invoker=new f.default,this._graphics=new m.default(this.ui?this.ui.getEditorArea():t,{cssMaxWidth:n.cssMaxWidth,cssMaxHeight:n.cssMaxHeight,useItext:!0,useDragAddIcon:!0}),this._handlers={keydown:this._onKeyDown.bind(this),mousedown:this._onMouseDown.bind(this),mouseup:this._onMouseUp.bind(this),mousemove:this._onMouseMove.bind(this),objectActivated:this._onObjectActivated.bind(this),objectRemoved:this._onObjectRemoved.bind(this),objectRotating:this._onObjectRotating.bind(this),objectMoved:this._onObjectMoved.bind(this),objectScaled:this._onObjectScaled.bind(this),createdPath:this._onCreatedPath,addText:this._onAddText.bind(this),addObject:this._onAddObject.bind(this),addObjectAfter:this._onAddObjectAfter.bind(this),textEditing:this._onTextEditing.bind(this),textChanged:this._onTextChanged.bind(this),iconCreateResize:this._onIconCreateResize.bind(this),iconCreateEnd:this._onIconCreateEnd.bind(this),selectionCleared:this._selectionCleared.bind(this),selectionCreated:this._selectionCreated.bind(this)},this._attachInvokerEvents(),this._attachGraphicsEvents(),this._attachDomEvents(),this._setSelectionStyle(n.selectionStyle,{applyCropSelectionStyle:n.applyCropSelectionStyle,applyGroupSelectionStyle:n.applyGroupSelectionStyle}),n.usageStatistics&&(0,b.sendHostName)(),this.ui&&(this.ui.initCanvas(),this.setReAction())}return r(e,[{key:"_setSelectionStyle",value:function(e,t){var n=t.applyCropSelectionStyle,i=t.applyGroupSelectionStyle;e&&this._graphics.setSelectionStyle(e),n&&this._graphics.setCropSelectionStyle(e),i&&this.on("selectionCreated",function(t){"group"===t.type&&t.set(e)})}},{key:"_attachInvokerEvents",value:function(){var e=x.UNDO_STACK_CHANGED,t=x.REDO_STACK_CHANGED;this._invoker.on(e,this.fire.bind(this,e)),this._invoker.on(t,this.fire.bind(this,t))}},{key:"_attachGraphicsEvents",value:function(){this._graphics.on({mousedown:this._handlers.mousedown,mouseup:this._handlers.mouseup,mousemove:this._handlers.mousemove,objectMoved:this._handlers.objectMoved,objectScaled:this._handlers.objectScaled,objectActivated:this._handlers.objectActivated,objectRemoved:this._handlers.objectRemoved,objectRotating:this._handlers.objectRotating,addText:this._handlers.addText,addObject:this._handlers.addObject,textEditing:this._handlers.textEditing,textChanged:this._handlers.textChanged,iconCreateResize:this._handlers.iconCreateResize,iconCreateEnd:this._handlers.iconCreateEnd,selectionCleared:this._handlers.selectionCleared,selectionCreated:this._handlers.selectionCreated,addObjectAfter:this._handlers.addObjectAfter})}},{key:"_attachDomEvents",value:function(){document.addEventListener("keydown",this._handlers.keydown)}},{key:"_detachDomEvents",value:function(){
document.removeEventListener("keydown",this._handlers.keydown)}},{key:"_onKeyDown",value:function(e){var t=this._graphics.getActiveObject(),n=this._graphics.getActiveGroupObject(),i=t||n,o=this.allowObjectRemoval;(e.ctrlKey||e.metaKey)&&e.keyCode===C.Z&&this.undo().catch(function(){}),(e.ctrlKey||e.metaKey)&&e.keyCode===C.Y&&this.redo().catch(function(){}),(e.keyCode===C.BACKSPACE||e.keyCode===C.DEL)&&i&&o&&(e.preventDefault(),this.removeActiveObject())}},{key:"removeActiveObject",value:function(){var e=this._graphics.getActiveObject(),t=this._graphics.getActiveGroupObject();if(t){var n=t.getObjects();this.discardSelection(),this._removeObjectStream(n)}else if(e){var i=this._graphics.getObjectId(e);this.removeObject(i)}}},{key:"_removeObjectStream",value:function(e){var t=this;if(!e.length)return!0;var n=e.pop();return this.removeObject(this._graphics.getObjectId(n)).then(function(){return t._removeObjectStream(e)})}},{key:"_onMouseDown",value:function(e,t){this.fire(x.MOUSE_DOWN,e,t)}},{key:"_onMouseUp",value:function(e,t){this.fire(x.MOUSE_UP,e,t)}},{key:"_onMouseMove",value:function(e,t){this.fire(x.MOUSE_MOVE,e,t)}},{key:"_pushAddObjectCommand",value:function(e){var t=g.default.create(w.ADD_OBJECT,this._graphics,e);this._invoker.pushUndoStack(t)}},{key:"_onObjectActivated",value:function(e){this.fire(x.OBJECT_ACTIVATED,e)}},{key:"_onObjectRemoved",value:function(e){this.fire(x.OBJECT_REMOVED,e)}},{key:"_onObjectRotating",value:function(e){this.fire(x.OBJECT_ROTATING,e)}},{key:"_onObjectMoved",value:function(e){this.fire(x.OBJECT_MOVED,e)}},{key:"_onObjectScaled",value:function(e){this.fire(x.OBJECT_SCALED,e)}},{key:"getDrawingMode",value:function(){return this._graphics.getDrawingMode()}},{key:"clearObjects",value:function(){return this.execute(w.CLEAR_OBJECTS)}},{key:"deactivateAll",value:function(){this._graphics.deactivateAll(),this._graphics.renderAll()}},{key:"discardSelection",value:function(){this._graphics.discardSelection()}},{key:"changeSelectableAll",value:function(e){this._graphics.changeSelectableAll(e)}},{key:"execute",value:function(e){for(var t,n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var r=[this._graphics].concat(i);return(t=this._invoker).execute.apply(t,[e].concat(r))}},{key:"undo",value:function(){return this._invoker.undo()}},{key:"redo",value:function(){return this._invoker.redo()}},{key:"loadImageFromFile",value:function(e,t){if(!e)return c.default.reject(E.invalidParameters);var n=URL.createObjectURL(e);return t=t||e.name,this.loadImageFromURL(n,t).then(function(t){return URL.revokeObjectURL(e),t})}},{key:"loadImageFromURL",value:function(e,t){return t&&e?this.execute(w.LOAD_IMAGE,t,e):c.default.reject(E.invalidParameters)}},{key:"addImageObject",value:function(e){return e?this.execute(w.ADD_IMAGE_OBJECT,e):c.default.reject(E.invalidParameters)}},{key:"startDrawingMode",value:function(e,t){return this._graphics.startDrawingMode(e,t)}},{key:"stopDrawingMode",value:function(){this._graphics.stopDrawingMode()}},{key:"crop",value:function(e){var t=this._graphics.getCroppedImageData(e);return t?this.loadImageFromURL(t.url,t.imageName):c.default.reject(E.invalidParameters)}},{key:"getCropzoneRect",value:function(){return this._graphics.getCropzoneRect()}},{key:"setCropzoneRect",value:function(e){this._graphics.setCropzoneRect(e)}},{key:"_flip",value:function(e){return this.execute(w.FLIP_IMAGE,e)}},{key:"flipX",value:function(){return this._flip("flipX")}},{key:"flipY",value:function(){return this._flip("flipY")}},{key:"resetFlip",value:function(){return this._flip("reset")}},{key:"_rotate",value:function(e,t){return this.execute(w.ROTATE_IMAGE,e,t)}},{key:"rotate",value:function(e){return this._rotate("rotate",e)}},{key:"setAngle",value:function(e){return this._rotate("setAngle",e)}},{key:"setBrush",value:function(e){this._graphics.setBrush(e)}},{key:"setDrawingShape",value:function(e,t){this._graphics.setDrawingShape(e,t)}},{key:"addShape",value:function(e,t){return t=t||{},this._setPositions(t),this.execute(w.ADD_SHAPE,e,t)}},{key:"changeShape",value:function(e,t){return this.execute(w.CHANGE_SHAPE,e,t)}},{key:"addText",value:function(e,t){return e=e||"",t=t||{},this.execute(w.ADD_TEXT,e,t)}},{key:"changeText",value:function(e,t){return t=t||"",this.execute(w.CHANGE_TEXT,e,t)}},{key:"changeTextStyle",value:function(e,t){return this.execute(w.CHANGE_TEXT_STYLE,e,t)}},{key:"_changeActivateMode",value:function(e){"ICON"!==e&&this.getDrawingMode()!==e&&this.startDrawingMode(e)}},{key:"_onTextChanged",value:function(e){this.changeText(e.id,e.text)}},{key:"_onIconCreateResize",value:function(e){this.fire(x.ICON_CREATE_RESIZE,e)}},{key:"_onIconCreateEnd",value:function(e){this.fire(x.ICON_CREATE_END,e)}},{key:"_onTextEditing",value:function(){this.fire(x.TEXT_EDITING)}},{key:"_onAddText",value:function(e){this.fire(x.ADD_TEXT,{originPosition:e.originPosition,clientPosition:e.clientPosition})}},{key:"_onAddObject",value:function(e){var t=this._graphics.getObject(e.id);this._pushAddObjectCommand(t)}},{key:"_onAddObjectAfter",value:function(e){this.fire(x.ADD_OBJECT_AFTER,e)}},{key:"_selectionCleared",value:function(){this.fire(x.SELECTION_CLEARED)}},{key:"_selectionCreated",value:function(e){e.set({lockRotation:!0,lockScalingX:!0,lockScalingY:!0,hasControls:!1}),this.fire(x.SELECTION_CREATED,e)}},{key:"registerIcons",value:function(e){this._graphics.registerPaths(e)}},{key:"changeCursor",value:function(e){this._graphics.changeCursor(e)}},{key:"addIcon",value:function(e,t){return t=t||{},this._setPositions(t),this.execute(w.ADD_ICON,e,t)}},{key:"changeIconColor",value:function(e,t){return this.execute(w.CHANGE_ICON_COLOR,e,t)}},{key:"removeObject",value:function(e){return this.execute(w.REMOVE_OBJECT,e)}},{key:"hasFilter",value:function(e){return this._graphics.hasFilter(e)}},{key:"removeFilter",value:function(e){return this.execute(w.REMOVE_FILTER,e)}},{key:"applyFilter",value:function(e,t){return this.execute(w.APPLY_FILTER,e,t)}},{key:"toDataURL",value:function(e){return this._graphics.toDataURL(e)}},{key:"getImageName",value:function(){return this._graphics.getImageName()}},{key:"clearUndoStack",value:function(){this._invoker.clearUndoStack()}},{key:"clearRedoStack",value:function(){this._invoker.clearRedoStack()}},{key:"isEmptyUndoStack",value:function(){return this._invoker.isEmptyUndoStack()}},{key:"isEmptyRedoStack",value:function(){return this._invoker.isEmptyRedoStack()}},{key:"resizeCanvasDimension",value:function(e){return e?this.execute(w.RESIZE_CANVAS_DIMENSION,e):c.default.reject(E.invalidParameters)}},{key:"resizeCanvasDimensionQuietly",value:function(e){return this._graphics.setCssMaxDimension(e),this._graphics.adjustCanvasDimension(),c.default.resolve()}},{key:"destroy",value:function(){var e=this;this.stopDrawingMode(),this._detachDomEvents(),this._graphics.destroy(),this._graphics=null,M(this,function(t,n){e[n]=null},this)}},{key:"_setPositions",value:function(e){var t=this._graphics.getCenter();j(e.left)&&(e.left=t.left),j(e.top)&&(e.top=t.top)}},{key:"setObjectProperties",value:function(e,t){return this.execute(w.SET_OBJECT_PROPERTIES,e,t)}},{key:"setObjectPropertiesQuietly",value:function(e,t){this._graphics.setObjectProperties(e,t)}},{key:"getObjectProperties",value:function(e,t){var n=this._graphics.getObject(e);return n?this._graphics.getObjectProperties(e,t):null}},{key:"getCanvasSize",value:function(){return this._graphics.getCanvasSize()}},{key:"getCanvasZoom",value:function(){return this._graphics.getCanvasZoom()}},{key:"getCurrentAngle",value:function(){return this._graphics.getCanvasImage().angle}},{key:"getObjectPosition",value:function(e,t,n){return this._graphics.getObjectPosition(e,t,n)}},{key:"setObjectPosition",value:function(e,t){return this.execute(w.SET_OBJECT_POSITION,e,t)}},{key:"setCanvasZoom",value:function(e){this._graphics.setCanvasZoom(e)}},{key:"setAllowObjectRemoval",value:function(e){this.allowObjectRemoval=e}}]),e}();d.default.mixin(S),k.default.mixin(S),e.exports=S},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(29),s=i(a),u=s.default.create,c=s.default.types,l=function(){function e(t,n){o(this,e),this.name=t.name,this.args=n,this.execute=t.execute,this.undo=t.undo,this.executeCallback=t.executeCallback||null,this.undoCallback=t.undoCallback||null,this.undoData={}}return r(e,[{key:"execute",value:function(){throw new Error(u(c.UN_IMPLEMENTATION,"execute"))}},{key:"undo",value:function(){throw new Error(u(c.UN_IMPLEMENTATION,"undo"))}},{key:"setExecuteCallback",value:function(e){return this.executeCallback=e,this}},{key:"setUndoCallback",value:function(e){return this.undoCallback=e,this}}]),e}();e.exports=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(4),s=i(a),u=n(2),c=i(u),l=n(3),f=i(l),h=n(1),d=i(h),p=n(21),g=i(p),v=d.default.eventNames,m=d.default.rejectMessages,y=s.default.isFunction,_=s.default.isString,b=function(){function e(){o(this,e),this._undoStack=[],this._redoStack=[],this._isLocked=!1}return r(e,[{key:"_invokeExecution",value:function(e){var t=this;this.lock();var n=e.args;return n||(n=[]),e.execute.apply(e,n).then(function(n){return t.pushUndoStack(e),t.unlock(),y(e.executeCallback)&&e.executeCallback(n),n}).catch(function(e){return t.unlock(),c.default.reject(e)})}},{key:"_invokeUndo",value:function(e){var t=this;this.lock();var n=e.args;return n||(n=[]),e.undo.apply(e,n).then(function(n){return t.pushRedoStack(e),t.unlock(),y(e.undoCallback)&&e.undoCallback(n),n}).catch(function(e){return t.unlock(),c.default.reject(e)})}},{key:"_fireRedoStackChanged",value:function(){this.fire(v.REDO_STACK_CHANGED,this._redoStack.length)}},{key:"_fireUndoStackChanged",value:function(){this.fire(v.UNDO_STACK_CHANGED,this._undoStack.length)}},{key:"lock",value:function(){this._isLocked=!0}},{key:"unlock",value:function(){this._isLocked=!1}},{key:"execute",value:function(){var e=this;if(this._isLocked)return c.default.reject(m.isLock);for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=n[0];return _(o)&&(o=f.default.create.apply(f.default,n)),this._invokeExecution(o).then(function(t){return e.clearRedoStack(),t})}},{key:"undo",value:function(){var e=this._undoStack.pop(),t=void 0,n="";return e&&this._isLocked&&(this.pushUndoStack(e,!0),e=null),e?(this.isEmptyUndoStack()&&this._fireUndoStackChanged(),t=this._invokeUndo(e)):(n=m.undo,this._isLocked&&(n=n+" Because "+m.isLock),t=c.default.reject(n)),t}},{key:"redo",value:function(){var e=this._redoStack.pop(),t=void 0,n="";return e&&this._isLocked&&(this.pushRedoStack(e,!0),e=null),e?(this.isEmptyRedoStack()&&this._fireRedoStackChanged(),t=this._invokeExecution(e)):(n=m.redo,this._isLocked&&(n=n+" Because "+m.isLock),t=c.default.reject(n)),t}},{key:"pushUndoStack",value:function(e,t){this._undoStack.push(e),t||this._fireUndoStackChanged()}},{key:"pushRedoStack",value:function(e,t){this._redoStack.push(e),t||this._fireRedoStackChanged()}},{key:"isEmptyRedoStack",value:function(){return 0===this._redoStack.length}},{key:"isEmptyUndoStack",value:function(){return 0===this._undoStack.length}},{key:"clearUndoStack",value:function(){this.isEmptyUndoStack()||(this._undoStack=[],this._fireUndoStackChanged())}},{key:"clearRedoStack",value:function(){this.isEmptyRedoStack()||(this._redoStack=[],this._fireRedoStackChanged())}}]),e}();g.default.mixin(b),e.exports=b},function(e,t){"use strict";Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||!function(e){if("Element"in e){var t="classList",n="prototype",i=e.Element[n],o=Object,r=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[n].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},s=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},u=function(e,t){if(""===t)throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(e,t)},c=function(e){for(var t=r.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],i=0,o=n.length;i<o;i++)this.push(n[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},l=c[n]=[],f=function(){return new c(this)};if(s[n]=Error[n],l.item=function(e){return this[e]||null},l.contains=function(e){return e+="",u(this,e)!==-1},l.add=function(){var e,t=arguments,n=0,i=t.length,o=!1;do e=t[n]+"",u(this,e)===-1&&(this.push(e),o=!0);while(++n<i);o&&this._updateClassName()},l.remove=function(){var e,t,n=arguments,i=0,o=n.length,r=!1;do for(e=n[i]+"",t=u(this,e);t!==-1;)this.splice(t,1),r=!0,t=u(this,e);while(++i<o);r&&this._updateClassName()},l.toggle=function(e,t){e+="";var n=this.contains(e),i=n?t!==!0&&"remove":t!==!1&&"add";return i&&this[i](e),t===!0||t===!1?t:!n},l.toString=function(){return this.join(" ")},o.defineProperty){var h={get:f,enumerable:!0,configurable:!0};try{o.defineProperty(i,t,h)}catch(e){void 0!==e.number&&e.number!==-2146823252||(h.enumerable=!1,o.defineProperty(i,t,h))}}else o[n].__defineGetter__&&i.__defineGetter__(t,f)}}(window.self),function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var n,i=arguments.length;for(n=0;n<i;n++)e=arguments[n],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:n.call(this,e)}}e=null}())},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var i=n(28),o=n(40),r=n(113);e.exports=function(e){return function(t,n,a){var s,u=i(t),c=o(u.length),l=r(a,c);if(e&&n!=n){for(;c>l;)if(s=u[l++],s!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var i=n(17),o=n(98),r=n(97),a=n(10),s=n(40),u=n(116),c={},l={},t=e.exports=function(e,t,n,f,h){var d,p,g,v,m=h?function(){return e}:u(e),y=i(n,f,t?2:1),_=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(r(m)){for(d=s(e.length);d>_;_++)if(v=t?y(a(p=e[_])[0],p[1]):y(e[_]),v===c||v===l)return v}else for(g=m.call(e);!(p=g.next()).done;)if(v=o(g,y,p.value,t),v===c||v===l)return v};t.BREAK=c,t.RETURN=l},function(e,t,n){e.exports=!n(14)&&!n(33)(function(){return 7!=Object.defineProperty(n(24)("div"),"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var i=n(16);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t,n){var i=n(15),o=n(6)("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||r[o]===e)}},function(e,t,n){var i=n(10);e.exports=function(e,t,n,o){try{return o?t(i(n)[0],n[1]):t(n)}catch(t){var r=e.return;throw void 0!==r&&i(r.call(e)),t}}},function(e,t,n){"use strict";var i=n(103),o=n(37),r=n(25),a={};n(11)(a,n(6)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(a,{next:o(1,n)}),r(e,t+" Iterator")}},function(e,t,n){var i=n(6)("iterator"),o=!1;try{var r=[7][i]();r.return=function(){o=!0},Array.from(r,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var r=[7],a=r[i]();a.next=function(){return{done:n=!0}},r[i]=function(){return a},e(r)}catch(e){}return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var i=n(8),o=n(39).set,r=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,u="process"==n(16)(a);e.exports=function(){var e,t,n,c=function(){var i,o;for(u&&(i=a.domain)&&i.exit();e;){o=e.fn,e=e.next;try{o()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(u)n=function(){a.nextTick(c)};else if(r){var l=!0,f=document.createTextNode("");new r(c).observe(f,{characterData:!0}),n=function(){f.data=l=!l}}else if(s&&s.resolve){var h=s.resolve();n=function(){h.then(c)}}else n=function(){o.call(i,c)};return function(i){var o={fn:i,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t,n){var i=n(10),o=n(104),r=n(31),a=n(26)("IE_PROTO"),s=function(){},u="prototype",c=function(){var e,t=n(24)("iframe"),i=r.length,o="<",a=">";for(t.style.display="none",n(34).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write(o+"script"+a+"document.F=Object"+o+"/script"+a),e.close(),c=e.F;i--;)delete c[u][r[i]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[u]=i(e),n=new s,s[u]=null,n[a]=e):n=c(),void 0===t?n:o(n,t)}},function(e,t,n){var i=n(20),o=n(10),r=n(107);e.exports=n(14)?Object.defineProperties:function(e,t){o(e);for(var n,a=r(t),s=a.length,u=0;s>u;)i.f(e,n=a[u++],t[n]);return e}},function(e,t,n){var i=n(18),o=n(114),r=n(26)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),i(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var i=n(18),o=n(28),r=n(92)(!1),a=n(26)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),u=0,c=[];for(n in s)n!=a&&i(s,n)&&c.push(n);for(;t.length>u;)i(s,n=t[u++])&&(~r(c,n)||c.push(n));return c}},function(e,t,n){var i=n(106),o=n(31);e.exports=Object.keys||function(e){return i(e,o)}},function(e,t,n){var i=n(11);e.exports=function(e,t,n){for(var o in t)n&&e[o]?e[o]=t[o]:i(e,o,t[o]);return e}},function(e,t,n){e.exports=n(11)},function(e,t,n){"use strict";var i=n(8),o=n(13),r=n(20),a=n(14),s=n(6)("species");e.exports=function(e){var t="function"==typeof o[e]?o[e]:i[e];a&&t&&!t[s]&&r.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var i=n(10),o=n(22),r=n(6)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||void 0==(n=i(a)[r])?t:o(n)}},function(e,t,n){var i=n(27),o=n(23);e.exports=function(e){return function(t,n){var r,a,s=String(o(t)),u=i(n),c=s.length;return u<0||u>=c?e?"":void 0:(r=s.charCodeAt(u),r<55296||r>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?e?s.charAt(u):r:e?s.slice(u,u+2):(r-55296<<10)+(a-56320)+65536)}}},function(e,t,n){var i=n(27),o=Math.max,r=Math.min;e.exports=function(e,t){return e=i(e),e<0?o(e+t,0):r(e,t)}},function(e,t,n){var i=n(23);e.exports=function(e){return Object(i(e))}},function(e,t,n){var i=n(19);e.exports=function(e,t){if(!i(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!i(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var i=n(30),o=n(6)("iterator"),r=n(15);e.exports=n(13).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||r[i(e)]}},function(e,t,n){"use strict";var i=n(90),o=n(101),r=n(15),a=n(28);e.exports=n(35)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):"keys"==t?o(0,n):"values"==t?o(0,e[n]):o(0,[n,e[n]])},"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(e,t){},function(e,t,n){"use strict";var i,o,r,a=n(36),s=n(8),u=n(17),c=n(30),l=n(32),f=n(19),h=n(22),d=n(91),p=n(93),g=n(111),v=n(39).set,m=n(102)(),y="Promise",_=s.TypeError,b=s.process,O=s[y],b=s.process,k="process"==c(b),x=function(){},w=!!function(){try{var e=O.resolve(1),t=(e.constructor={})[n(6)("species")]=function(e){e(x,x)};return(k||"function"==typeof PromiseRejectionEvent)&&e.then(x)instanceof t}catch(e){}}(),C=function(e,t){return e===t||e===O&&t===r},E=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},j=function(e){return C(O,e)?new M(e):new o(e)},M=o=function(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw _("Bad Promise constructor");t=e,n=i}),this.resolve=h(t),this.reject=h(n)},S=function(e){try{e()}catch(e){return{error:e}}},T=function(e,t){if(!e._n){e._n=!0;var n=e._c;m(function(){for(var i=e._v,o=1==e._s,r=0,a=function(t){var n,r,a=o?t.ok:t.fail,s=t.resolve,u=t.reject,c=t.domain;try{a?(o||(2==e._h&&P(e),e._h=1),a===!0?n=i:(c&&c.enter(),n=a(i),c&&c.exit()),n===t.promise?u(_("Promise-chain cycle")):(r=E(n))?r.call(n,s,u):s(n)):u(i)}catch(e){u(e)}};n.length>r;)a(n[r++]);e._c=[],e._n=!1,t&&!e._h&&A(e)})}},A=function(e){v.call(s,function(){var t,n,i,o=e._v;if(I(e)&&(t=S(function(){k?b.emit("unhandledRejection",o,e):(n=s.onunhandledrejection)?n({promise:e,reason:o}):(i=s.console)&&i.error&&i.error("Unhandled promise rejection",o)}),e._h=k||I(e)?2:1),e._a=void 0,t)throw t.error})},I=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,i=0;n.length>i;)if(t=n[i++],t.fail||!I(t.promise))return!1;return!0},P=function(e){v.call(s,function(){var t;k?b.emit("rejectionHandled",e):(t=s.onrejectionhandled)&&t({promise:e,reason:e._v})})},D=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),T(t,!0))},R=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw _("Promise can't be resolved itself");(t=E(e))?m(function(){var i={_w:n,_d:!1};try{t.call(e,u(R,i,1),u(D,i,1))}catch(e){D.call(i,e)}}):(n._v=e,n._s=1,T(n,!1))}catch(e){D.call({_w:n,_d:!1},e)}}};w||(O=function(e){d(this,O,y,"_h"),h(e),i.call(this);try{e(u(R,this,1),u(D,this,1))}catch(e){D.call(this,e)}},i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n(108)(O.prototype,{then:function(e,t){var n=j(g(this,O));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=k?b.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&T(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),M=function(){var e=new i;this.promise=e,this.resolve=u(R,e,1),this.reject=u(D,e,1)}),l(l.G+l.W+l.F*!w,{Promise:O}),n(25)(O,y),n(110)(y),r=n(13)[y],l(l.S+l.F*!w,y,{reject:function(e){var t=j(this),n=t.reject;return n(e),t.promise}}),l(l.S+l.F*(a||!w),y,{resolve:function(e){if(e instanceof O&&C(e.constructor,this))return e;var t=j(this),n=t.resolve;return n(e),t.promise}}),l(l.S+l.F*!(w&&n(100)(function(e){O.all(e).catch(x)})),y,{all:function(e){var t=this,n=j(t),i=n.resolve,o=n.reject,r=S(function(){var n=[],r=0,a=1;p(e,!1,function(e){var s=r++,u=!1;n.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,n[s]=e,--a||i(n))},o)}),--a||i(n)});return r&&o(r.error),n.promise},race:function(e){var t=this,n=j(t),i=n.reject,o=S(function(){p(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return o&&i(o.error),n.promise}})},function(e,t,n){"use strict";var i=n(112)(!0);n(35)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){n(117);for(var i=n(8),o=n(11),r=n(15),a=n(6)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var c=s[u],l=i[c],f=l&&l.prototype;f&&!f[a]&&o(f,a,c),r[c]=r.Array}}])});